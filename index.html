<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.305">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vincent van Hoef">

<title>Tumor progression in breast cancer reflected in gene expression patterns and mutational profile</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script type="module" src="index_files/libs/quarto-ojs/esbuild-bundle.js"></script>
<link href="index_files/libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="index_files/libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="index_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="index_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="index_files/libs/datatables-binding-0.18/datatables.js"></script>
<link href="index_files/libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="index_files/libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="index_files/libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<script src="index_files/libs/jszip-1.10.20/jszip.min.js"></script>
<link href="index_files/libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="index_files/libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="index_files/libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="index_files/libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="index_files/libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="index_files/libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="index_files/libs/dt-ext-scroller-1.10.20/css/scroller.dataTables.min.css" rel="stylesheet">
<script src="index_files/libs/dt-ext-scroller-1.10.20/js/dataTables.scroller.min.js"></script>
<link href="index_files/libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="index_files/libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script type="ojs-define">
{"contents":[{"name":"plots","value":["H408","H413","L002","L004","L008","L010","L011","L012","L016","L024","L025","L028","L030","L036","L040","L043","L050","L053","L062","L064","L065","L070","L077","L079","L082","L083","M201","M202","M205","M213","M216","M219","M221","M222","M225","M226","M229","M235","M241","M242","M243","M252","M253","M254","M256","M263","M264"]}]}
</script>
<script type="ojs-define">
{"contents":[{"name":"plots_lnm","value":["H401","H403","H404","H405","H406","H408","H411","H413","L001","L002","L003","L004","L008","L012","L018","L022","L024","L028","L030","L034","L038","L040","L043","L044","L054","L056","L062","L065","L067","L068","L070","L072","L077","L079","L082","L086","M202","M203","M206","M209","M210","M212","M214","M216","M222","M224","M229","M235","M237","M242","M246","M248","M250","M253","M254"]}]}
</script>


<link rel="stylesheet" href="./assets/style.css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Tumor progression in breast cancer reflected in gene expression patterns and mutational profile</h1>
            <p class="subtitle lead">Project #5975</p>
                </div>
  </div>
    
  



  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vincent van Hoef </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">5/6/22</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#material-and-methods" id="toc-material-and-methods" class="nav-link" data-scroll-target="#material-and-methods">Material and Methods</a>
  <ul class="collapse">
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing">Preprocessing</a></li>
  <li><a href="#variant-calling" id="toc-variant-calling" class="nav-link" data-scroll-target="#variant-calling">Variant Calling</a></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering">Filtering</a></li>
  <li><a href="#copy-number-analysis" id="toc-copy-number-analysis" class="nav-link" data-scroll-target="#copy-number-analysis">Copy Number Analysis</a></li>
  <li><a href="#tumor-mutational-burden" id="toc-tumor-mutational-burden" class="nav-link" data-scroll-target="#tumor-mutational-burden">Tumor Mutational Burden</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#quality-control" id="toc-quality-control" class="nav-link" data-scroll-target="#quality-control">Quality control</a>
  <ul class="collapse">
  <li><a href="#fastqc" id="toc-fastqc" class="nav-link" data-scroll-target="#fastqc">FastQC</a></li>
  <li><a href="#coverage" id="toc-coverage" class="nav-link" data-scroll-target="#coverage">Coverage</a></li>
  </ul></li>
  <li><a href="#variant-calling-1" id="toc-variant-calling-1" class="nav-link" data-scroll-target="#variant-calling-1">Variant Calling</a></li>
  <li><a href="#tumor-mutational-burden-1" id="toc-tumor-mutational-burden-1" class="nav-link" data-scroll-target="#tumor-mutational-burden-1">Tumor Mutational Burden</a></li>
  <li><a href="#copy-number-alteration" id="toc-copy-number-alteration" class="nav-link" data-scroll-target="#copy-number-alteration">Copy Number Alteration</a></li>
  <li><a href="#nanostring-data" id="toc-nanostring-data" class="nav-link" data-scroll-target="#nanostring-data">Nanostring data</a></li>
  </ul></li>
  <li><a href="#data-responsibility" id="toc-data-responsibility" class="nav-link" data-scroll-target="#data-responsibility">Data Responsibility</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  <li><a href="#closing-procedures" id="toc-closing-procedures" class="nav-link" data-scroll-target="#closing-procedures">Closing Procedures</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">
<!-- Add icon library -->
<link rel="stylesheet" href="./assets/font-awesome-4.7.0/css/font-awesome.min.css">
<script type="module">
    // quarto-ojs.js
import { Interpreter as Interpreter2 } from "https://cdn.skypack.dev/@alex.garcia/unofficial-observablehq-compiler@0.6.0-alpha.9";
import {
  Inspector as Inspector4,
  Runtime as Runtime2,
  RuntimeError as RuntimeError2
} from "https://cdn.skypack.dev/@observablehq/runtime@4.18.3";

// stdlib.js
var e = {};
var t = {};
function n(e2) {
  return new Function("d", "return {" + e2.map(function(e3, t2) {
    return JSON.stringify(e3) + ": d[" + t2 + '] || ""';
  }).join(",") + "}");
}
function r(e2) {
  var t2 = Object.create(null), n2 = [];
  return e2.forEach(function(e3) {
    for (var r2 in e3)
      r2 in t2 || n2.push(t2[r2] = r2);
  }), n2;
}
function o(e2, t2) {
  var n2 = e2 + "", r2 = n2.length;
  return r2 < t2 ? new Array(t2 - r2 + 1).join(0) + n2 : n2;
}
function i(e2) {
  var t2, n2 = e2.getUTCHours(), r2 = e2.getUTCMinutes(), i2 = e2.getUTCSeconds(), a2 = e2.getUTCMilliseconds();
  return isNaN(e2) ? "Invalid Date" : ((t2 = e2.getUTCFullYear()) < 0 ? "-" + o(-t2, 6) : t2 > 9999 ? "+" + o(t2, 6) : o(t2, 4)) + "-" + o(e2.getUTCMonth() + 1, 2) + "-" + o(e2.getUTCDate(), 2) + (a2 ? "T" + o(n2, 2) + ":" + o(r2, 2) + ":" + o(i2, 2) + "." + o(a2, 3) + "Z" : i2 ? "T" + o(n2, 2) + ":" + o(r2, 2) + ":" + o(i2, 2) + "Z" : r2 || n2 ? "T" + o(n2, 2) + ":" + o(r2, 2) + "Z" : "");
}
function a(o2) {
  var a2 = new RegExp('["' + o2 + "\n\r]"), s2 = o2.charCodeAt(0);
  function u2(n2, r2) {
    var o3, i2 = [], a3 = n2.length, u3 = 0, l3 = 0, c3 = a3 <= 0, f3 = false;
    function d2() {
      if (c3)
        return t;
      if (f3)
        return f3 = false, e;
      var r3, o4, i3 = u3;
      if (n2.charCodeAt(i3) === 34) {
        for (; u3++ < a3 && n2.charCodeAt(u3) !== 34 || n2.charCodeAt(++u3) === 34; )
          ;
        return (r3 = u3) >= a3 ? c3 = true : (o4 = n2.charCodeAt(u3++)) === 10 ? f3 = true : o4 === 13 && (f3 = true, n2.charCodeAt(u3) === 10 && ++u3), n2.slice(i3 + 1, r3 - 1).replace(/""/g, '"');
      }
      for (; u3 < a3; ) {
        if ((o4 = n2.charCodeAt(r3 = u3++)) === 10)
          f3 = true;
        else if (o4 === 13)
          f3 = true, n2.charCodeAt(u3) === 10 && ++u3;
        else if (o4 !== s2)
          continue;
        return n2.slice(i3, r3);
      }
      return c3 = true, n2.slice(i3, a3);
    }
    for (n2.charCodeAt(a3 - 1) === 10 && --a3, n2.charCodeAt(a3 - 1) === 13 && --a3; (o3 = d2()) !== t; ) {
      for (var h2 = []; o3 !== e && o3 !== t; )
        h2.push(o3), o3 = d2();
      r2 && (h2 = r2(h2, l3++)) == null || i2.push(h2);
    }
    return i2;
  }
  function l2(e2, t2) {
    return e2.map(function(e3) {
      return t2.map(function(t3) {
        return f2(e3[t3]);
      }).join(o2);
    });
  }
  function c2(e2) {
    return e2.map(f2).join(o2);
  }
  function f2(e2) {
    return e2 == null ? "" : e2 instanceof Date ? i(e2) : a2.test(e2 += "") ? '"' + e2.replace(/"/g, '""') + '"' : e2;
  }
  return { parse: function(e2, t2) {
    var r2, o3, i2 = u2(e2, function(e3, i3) {
      if (r2)
        return r2(e3, i3 - 1);
      o3 = e3, r2 = t2 ? function(e4, t3) {
        var r3 = n(e4);
        return function(n2, o4) {
          return t3(r3(n2), o4, e4);
        };
      }(e3, t2) : n(e3);
    });
    return i2.columns = o3 || [], i2;
  }, parseRows: u2, format: function(e2, t2) {
    return t2 == null && (t2 = r(e2)), [t2.map(f2).join(o2)].concat(l2(e2, t2)).join("\n");
  }, formatBody: function(e2, t2) {
    return t2 == null && (t2 = r(e2)), l2(e2, t2).join("\n");
  }, formatRows: function(e2) {
    return e2.map(c2).join("\n");
  }, formatRow: c2, formatValue: f2 };
}
var s = a(",");
var u = s.parse;
var l = s.parseRows;
var c = a("	");
var f = c.parse;
var d = c.parseRows;
function h(e2) {
  for (var t2 in e2) {
    var n2, r2, o2 = e2[t2].trim();
    if (o2)
      if (o2 === "true")
        o2 = true;
      else if (o2 === "false")
        o2 = false;
      else if (o2 === "NaN")
        o2 = NaN;
      else if (isNaN(n2 = +o2)) {
        if (!(r2 = o2.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))
          continue;
        m && r2[4] && !r2[7] && (o2 = o2.replace(/-/g, "/").replace(/T/, " ")), o2 = new Date(o2);
      } else
        o2 = n2;
    else
      o2 = null;
    e2[t2] = o2;
  }
  return e2;
}
var m = new Date("2019-01-01T00:00").getHours() || new Date("2019-07-01T00:00").getHours();
var p = new Map();
var w = [];
var v = w.map;
var y = w.some;
var g = w.hasOwnProperty;
var b = "https://cdn.jsdelivr.net/npm/";
var x = /^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/;
var j = /^\d+\.\d+\.\d+(-[\w-.+]+)?$/;
var E = /\.[^/]*$/;
var P = ["unpkg", "jsdelivr", "browser", "main"];
var RequireError = class extends Error {
  constructor(e2) {
    super(e2);
  }
};
function C(e2) {
  const t2 = x.exec(e2);
  return t2 && { name: t2[1], version: t2[2], path: t2[3] };
}
function A(e2) {
  const t2 = `${b}${e2.name}${e2.version ? `@${e2.version}` : ""}/package.json`;
  let n2 = p.get(t2);
  return n2 || p.set(t2, n2 = fetch(t2).then((e3) => {
    if (!e3.ok)
      throw new RequireError("unable to load package.json");
    return e3.redirected && !p.has(e3.url) && p.set(e3.url, n2), e3.json();
  })), n2;
}
RequireError.prototype.name = RequireError.name;
var N = L(async function(e2, t2) {
  if (e2.startsWith(b) && (e2 = e2.substring(b.length)), /^(\w+:)|\/\//i.test(e2))
    return e2;
  if (/^[.]{0,2}\//i.test(e2))
    return new URL(e2, t2 == null ? location : t2).href;
  if (!e2.length || /^[\s._]/.test(e2) || /\s$/.test(e2))
    throw new RequireError("illegal name");
  const n2 = C(e2);
  if (!n2)
    return `${b}${e2}`;
  if (!n2.version && t2 != null && t2.startsWith(b)) {
    const e3 = await A(C(t2.substring(b.length)));
    n2.version = e3.dependencies && e3.dependencies[n2.name] || e3.peerDependencies && e3.peerDependencies[n2.name];
  }
  if (n2.path && !E.test(n2.path) && (n2.path += ".js"), n2.path && n2.version && j.test(n2.version))
    return `${b}${n2.name}@${n2.version}/${n2.path}`;
  const r2 = await A(n2);
  return `${b}${r2.name}@${r2.version}/${n2.path || function(e3) {
    for (const t3 of P) {
      const n3 = e3[t3];
      if (typeof n3 == "string")
        return E.test(n3) ? n3 : `${n3}.js`;
    }
  }(r2) || "index.js"}`;
});
function L(e2) {
  const t2 = new Map(), n2 = a2(null);
  let r2, o2 = 0;
  function i2(e3) {
    if (typeof e3 != "string")
      return e3;
    let n3 = t2.get(e3);
    return n3 || t2.set(e3, n3 = new Promise((t3, n4) => {
      const i3 = document.createElement("script");
      i3.onload = () => {
        try {
          t3(w.pop()(a2(e3)));
        } catch (e4) {
          n4(new RequireError("invalid module"));
        }
        i3.remove(), o2--, o2 === 0 && (window.define = r2);
      }, i3.onerror = () => {
        n4(new RequireError("unable to load module")), i3.remove(), o2--, o2 === 0 && (window.define = r2);
      }, i3.async = true, i3.src = e3, o2 === 0 && (r2 = window.define, window.define = k), o2++, document.head.appendChild(i3);
    })), n3;
  }
  function a2(t3) {
    return (n3) => Promise.resolve(e2(n3, t3)).then(i2);
  }
  function s2(e3) {
    return arguments.length > 1 ? Promise.all(v.call(arguments, n2)).then(O) : n2(e3);
  }
  return s2.alias = function(t3) {
    return L((n3, r3) => n3 in t3 && (r3 = null, typeof (n3 = t3[n3]) != "string") ? n3 : e2(n3, r3));
  }, s2.resolve = e2, s2;
}
function O(e2) {
  const t2 = {};
  for (const n2 of e2)
    for (const e3 in n2)
      g.call(n2, e3) && (n2[e3] == null ? Object.defineProperty(t2, e3, { get: R(n2, e3) }) : t2[e3] = n2[e3]);
  return t2;
}
function R(e2, t2) {
  return () => e2[t2];
}
function $2(e2) {
  return (e2 += "") === "exports" || e2 === "module";
}
function k(e2, t2, n2) {
  const r2 = arguments.length;
  r2 < 2 ? (n2 = e2, t2 = []) : r2 < 3 && (n2 = t2, t2 = typeof e2 == "string" ? [] : e2), w.push(y.call(t2, $2) ? (e3) => {
    const r3 = {}, o2 = { exports: r3 };
    return Promise.all(v.call(t2, (t3) => (t3 += "") === "exports" ? r3 : t3 === "module" ? o2 : e3(t3))).then((e4) => (n2.apply(null, e4), o2.exports));
  } : (e3) => Promise.all(v.call(t2, e3)).then((e4) => typeof n2 == "function" ? n2.apply(null, e4) : n2));
}
function T(e2, t2, n2) {
  return { resolve: (r2 = n2) => `https://cdn.jsdelivr.net/npm/${e2}@${t2}/${r2}` };
}
k.amd = {};
var U = T("d3", "7.0.1", "dist/d3.min.js");
var q = T("@observablehq/inputs", "0.9.1", "dist/inputs.min.js");
var M = T("@observablehq/plot", "0.2.0", "dist/plot.umd.min.js");
var S = T("@observablehq/graphviz", "0.2.1", "dist/graphviz.min.js");
var _ = T("@observablehq/highlight.js", "2.0.0", "highlight.min.js");
var D = T("@observablehq/katex", "0.11.1", "dist/katex.min.js");
var F = T("lodash", "4.17.21", "lodash.min.js");
var B = T("htl", "0.3.0", "dist/htl.min.js");
var z = T("jszip", "3.7.1", "dist/jszip.min.js");
var H = T("marked", "0.3.12", "marked.min.js");
var W = T("sql.js", "1.6.1", "dist/sql-wasm.js");
var I = T("vega", "5.20.2", "build/vega.min.js");
var Z = T("vega-lite", "5.1.0", "build/vega-lite.min.js");
var Q = T("vega-lite-api", "5.0.0", "build/vega-lite-api.min.js");
var V = T("apache-arrow", "4.0.1", "Arrow.es2015.min.js");
var J = T("arquero", "4.8.4", "dist/arquero.min.js");
var X = T("topojson-client", "3.1.0", "dist/topojson-client.min.js");
function Y(e2) {
  const t2 = {};
  for (const [n2, r2] of e2)
    t2[n2] = r2;
  return t2;
}
async function G(e2) {
  return (await e2(W.resolve()))({ locateFile: (e3) => W.resolve(`dist/${e3}`) });
}
var SQLiteDatabaseClient = class {
  constructor(e2) {
    Object.defineProperties(this, { _db: { value: e2 } });
  }
  static async open(e2) {
    const [t2, n2] = await Promise.all([G(N), Promise.resolve(e2).then(K)]);
    return new SQLiteDatabaseClient(new t2.Database(n2));
  }
  async query(e2, t2) {
    return await async function(e3, t3, n2) {
      const [r2] = await e3.exec(t3, n2);
      if (!r2)
        return [];
      const { columns: o2, values: i2 } = r2, a2 = i2.map((e4) => Y(e4.map((e5, t4) => [o2[t4], e5])));
      return a2.columns = o2, a2;
    }(this._db, e2, t2);
  }
  async queryRow(e2, t2) {
    return (await this.query(e2, t2))[0] || null;
  }
  async explain(e2, t2) {
    return ee("pre", { className: "observablehq--inspect" }, [te((await this.query(`EXPLAIN QUERY PLAN ${e2}`, t2)).map((e3) => e3.detail).join("\n"))]);
  }
  async describe(e2) {
    const t2 = await (e2 === void 0 ? this.query("SELECT name FROM sqlite_master WHERE type = 'table'") : this.query("SELECT * FROM pragma_table_info(?)", [e2]));
    if (!t2.length)
      throw new Error("Not found");
    const { columns: n2 } = t2;
    return ee("table", { value: t2 }, [ee("thead", [ee("tr", n2.map((e3) => ee("th", [te(e3)])))]), ee("tbody", t2.map((e3) => ee("tr", n2.map((t3) => ee("td", [te(e3[t3])])))))]);
  }
};
function K(e2) {
  return typeof e2 == "string" ? fetch(e2).then(K) : e2 instanceof Response || e2 instanceof Blob ? e2.arrayBuffer().then(K) : e2 instanceof ArrayBuffer ? new Uint8Array(e2) : e2;
}
function ee(e2, t2, n2) {
  arguments.length === 2 && (n2 = t2, t2 = void 0);
  const r2 = document.createElement(e2);
  if (t2 !== void 0)
    for (const e3 in t2)
      r2[e3] = t2[e3];
  if (n2 !== void 0)
    for (const e3 of n2)
      r2.appendChild(e3);
  return r2;
}
function te(e2) {
  return document.createTextNode(e2);
}
async function ne(e2) {
  const t2 = await fetch(await e2.url());
  if (!t2.ok)
    throw new Error(`Unable to load file: ${e2.name}`);
  return t2;
}
async function re(e2, t2, { array: n2 = false, typed: r2 = false } = {}) {
  const o2 = await e2.text();
  return (t2 === "	" ? n2 ? d : f : n2 ? l : u)(o2, r2 && h);
}
var oe = class {
  constructor(e2) {
    Object.defineProperty(this, "name", { value: e2, enumerable: true });
  }
  async blob() {
    return (await ne(this)).blob();
  }
  async arrayBuffer() {
    return (await ne(this)).arrayBuffer();
  }
  async text() {
    return (await ne(this)).text();
  }
  async json() {
    return (await ne(this)).json();
  }
  async stream() {
    return (await ne(this)).body;
  }
  async csv(e2) {
    return re(this, ",", e2);
  }
  async tsv(e2) {
    return re(this, "	", e2);
  }
  async image() {
    const e2 = await this.url();
    return new Promise((t2, n2) => {
      const r2 = new Image();
      new URL(e2, document.baseURI).origin !== new URL(location).origin && (r2.crossOrigin = "anonymous"), r2.onload = () => t2(r2), r2.onerror = () => n2(new Error(`Unable to load file: ${this.name}`)), r2.src = e2;
    });
  }
  async arrow() {
    const [e2, t2] = await Promise.all([N(V.resolve()), ne(this)]);
    return e2.Table.from(t2);
  }
  async sqlite() {
    return SQLiteDatabaseClient.open(ne(this));
  }
  async zip() {
    const [e2, t2] = await Promise.all([N(z.resolve()), this.arrayBuffer()]);
    return new ZipArchive(await e2.loadAsync(t2));
  }
  async xml(e2 = "application/xml") {
    return new DOMParser().parseFromString(await this.text(), e2);
  }
  async html() {
    return this.xml("text/html");
  }
};
var FileAttachment = class extends oe {
  constructor(e2, t2) {
    super(t2), Object.defineProperty(this, "_url", { value: e2 });
  }
  async url() {
    return await this._url + "";
  }
};
function ie(e2) {
  throw new Error(`File not found: ${e2}`);
}
function ae(e2) {
  return Object.assign((t2) => {
    const n2 = e2(t2 += "");
    if (n2 == null)
      throw new Error(`File not found: ${t2}`);
    return new FileAttachment(n2, t2);
  }, { prototype: FileAttachment.prototype });
}
var ZipArchive = class {
  constructor(e2) {
    Object.defineProperty(this, "_", { value: e2 }), this.filenames = Object.keys(e2.files).filter((t2) => !e2.files[t2].dir);
  }
  file(e2) {
    const t2 = this._.file(e2 += "");
    if (!t2 || t2.dir)
      throw new Error(`file not found: ${e2}`);
    return new ZipArchiveEntry(t2);
  }
};
var ZipArchiveEntry = class extends oe {
  constructor(e2) {
    super(e2.name), Object.defineProperty(this, "_", { value: e2 }), Object.defineProperty(this, "_url", { writable: true });
  }
  async url() {
    return this._url || (this._url = this.blob().then(URL.createObjectURL));
  }
  async blob() {
    return this._.async("blob");
  }
  async arrayBuffer() {
    return this._.async("arraybuffer");
  }
  async text() {
    return this._.async("text");
  }
  async json() {
    return JSON.parse(await this.text());
  }
};
var se = { math: "http://www.w3.org/1998/Math/MathML", svg: "http://www.w3.org/2000/svg", xhtml: "http://www.w3.org/1999/xhtml", xlink: "http://www.w3.org/1999/xlink", xml: "http://www.w3.org/XML/1998/namespace", xmlns: "http://www.w3.org/2000/xmlns/" };
var ue = 0;
function le(e2) {
  this.id = e2, this.href = new URL(`#${e2}`, location) + "";
}
le.prototype.toString = function() {
  return "url(" + this.href + ")";
};
var ce = { canvas: function(e2, t2) {
  var n2 = document.createElement("canvas");
  return n2.width = e2, n2.height = t2, n2;
}, context2d: function(e2, t2, n2) {
  n2 == null && (n2 = devicePixelRatio);
  var r2 = document.createElement("canvas");
  r2.width = e2 * n2, r2.height = t2 * n2, r2.style.width = e2 + "px";
  var o2 = r2.getContext("2d");
  return o2.scale(n2, n2), o2;
}, download: function(e2, t2 = "untitled", n2 = "Save") {
  const r2 = document.createElement("a"), o2 = r2.appendChild(document.createElement("button"));
  async function i2() {
    await new Promise(requestAnimationFrame), URL.revokeObjectURL(r2.href), r2.removeAttribute("href"), o2.textContent = n2, o2.disabled = false;
  }
  return o2.textContent = n2, r2.download = t2, r2.onclick = async (t3) => {
    if (o2.disabled = true, r2.href)
      return i2();
    o2.textContent = "Saving\u2026";
    try {
      const t4 = await (typeof e2 == "function" ? e2() : e2);
      o2.textContent = "Download", r2.href = URL.createObjectURL(t4);
    } catch (e3) {
      o2.textContent = n2;
    }
    if (t3.eventPhase)
      return i2();
    o2.disabled = false;
  }, r2;
}, element: function(e2, t2) {
  var n2, r2 = e2 += "", o2 = r2.indexOf(":");
  o2 >= 0 && (r2 = e2.slice(0, o2)) !== "xmlns" && (e2 = e2.slice(o2 + 1));
  var i2 = se.hasOwnProperty(r2) ? document.createElementNS(se[r2], e2) : document.createElement(e2);
  if (t2)
    for (var a2 in t2)
      o2 = (r2 = a2).indexOf(":"), n2 = t2[a2], o2 >= 0 && (r2 = a2.slice(0, o2)) !== "xmlns" && (a2 = a2.slice(o2 + 1)), se.hasOwnProperty(r2) ? i2.setAttributeNS(se[r2], a2, n2) : i2.setAttribute(a2, n2);
  return i2;
}, input: function(e2) {
  var t2 = document.createElement("input");
  return e2 != null && (t2.type = e2), t2;
}, range: function(e2, t2, n2) {
  arguments.length === 1 && (t2 = e2, e2 = null);
  var r2 = document.createElement("input");
  return r2.min = e2 = e2 == null ? 0 : +e2, r2.max = t2 = t2 == null ? 1 : +t2, r2.step = n2 == null ? "any" : n2 = +n2, r2.type = "range", r2;
}, select: function(e2) {
  var t2 = document.createElement("select");
  return Array.prototype.forEach.call(e2, function(e3) {
    var n2 = document.createElement("option");
    n2.value = n2.textContent = e3, t2.appendChild(n2);
  }), t2;
}, svg: function(e2, t2) {
  var n2 = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  return n2.setAttribute("viewBox", [0, 0, e2, t2]), n2.setAttribute("width", e2), n2.setAttribute("height", t2), n2;
}, text: function(e2) {
  return document.createTextNode(e2);
}, uid: function(e2) {
  return new le("O-" + (e2 == null ? "" : e2 + "-") + ++ue);
} };
var fe = { buffer: function(e2) {
  return new Promise(function(t2, n2) {
    var r2 = new FileReader();
    r2.onload = function() {
      t2(r2.result);
    }, r2.onerror = n2, r2.readAsArrayBuffer(e2);
  });
}, text: function(e2) {
  return new Promise(function(t2, n2) {
    var r2 = new FileReader();
    r2.onload = function() {
      t2(r2.result);
    }, r2.onerror = n2, r2.readAsText(e2);
  });
}, url: function(e2) {
  return new Promise(function(t2, n2) {
    var r2 = new FileReader();
    r2.onload = function() {
      t2(r2.result);
    }, r2.onerror = n2, r2.readAsDataURL(e2);
  });
} };
function de() {
  return this;
}
function he(e2, t2) {
  let n2 = false;
  if (typeof t2 != "function")
    throw new Error("dispose is not a function");
  return { [Symbol.iterator]: de, next: () => n2 ? { done: true } : (n2 = true, { done: false, value: e2 }), return: () => (n2 = true, t2(e2), { done: true }), throw: () => ({ done: n2 = true }) };
}
function me(e2) {
  let t2, n2, r2 = false;
  const o2 = e2(function(e3) {
    n2 ? (n2(e3), n2 = null) : r2 = true;
    return t2 = e3;
  });
  if (o2 != null && typeof o2 != "function")
    throw new Error(typeof o2.then == "function" ? "async initializers are not supported" : "initializer returned something, but not a dispose function");
  return { [Symbol.iterator]: de, throw: () => ({ done: true }), return: () => (o2 != null && o2(), { done: true }), next: function() {
    return { done: false, value: r2 ? (r2 = false, Promise.resolve(t2)) : new Promise((e3) => n2 = e3) };
  } };
}
function pe(e2) {
  switch (e2.type) {
    case "range":
    case "number":
      return e2.valueAsNumber;
    case "date":
      return e2.valueAsDate;
    case "checkbox":
      return e2.checked;
    case "file":
      return e2.multiple ? e2.files : e2.files[0];
    case "select-multiple":
      return Array.from(e2.selectedOptions, (e3) => e3.value);
    default:
      return e2.value;
  }
}
var we = { disposable: he, filter: function* (e2, t2) {
  for (var n2, r2 = -1; !(n2 = e2.next()).done; )
    t2(n2.value, ++r2) && (yield n2.value);
}, input: function(e2) {
  return me(function(t2) {
    var n2 = function(e3) {
      switch (e3.type) {
        case "button":
        case "submit":
        case "checkbox":
          return "click";
        case "file":
          return "change";
        default:
          return "input";
      }
    }(e2), r2 = pe(e2);
    function o2() {
      t2(pe(e2));
    }
    return e2.addEventListener(n2, o2), r2 !== void 0 && t2(r2), function() {
      e2.removeEventListener(n2, o2);
    };
  });
}, map: function* (e2, t2) {
  for (var n2, r2 = -1; !(n2 = e2.next()).done; )
    yield t2(n2.value, ++r2);
}, observe: me, queue: function(e2) {
  let t2;
  const n2 = [], r2 = e2(function(e3) {
    n2.push(e3), t2 && (t2(n2.shift()), t2 = null);
    return e3;
  });
  if (r2 != null && typeof r2 != "function")
    throw new Error(typeof r2.then == "function" ? "async initializers are not supported" : "initializer returned something, but not a dispose function");
  return { [Symbol.iterator]: de, throw: () => ({ done: true }), return: () => (r2 != null && r2(), { done: true }), next: function() {
    return { done: false, value: n2.length ? Promise.resolve(n2.shift()) : new Promise((e3) => t2 = e3) };
  } };
}, range: function* (e2, t2, n2) {
  e2 = +e2, t2 = +t2, n2 = (o2 = arguments.length) < 2 ? (t2 = e2, e2 = 0, 1) : o2 < 3 ? 1 : +n2;
  for (var r2 = -1, o2 = 0 | Math.max(0, Math.ceil((t2 - e2) / n2)); ++r2 < o2; )
    yield e2 + r2 * n2;
}, valueAt: function(e2, t2) {
  if (!(!isFinite(t2 = +t2) || t2 < 0 || t2 != t2 | 0)) {
    for (var n2, r2 = -1; !(n2 = e2.next()).done; )
      if (++r2 === t2)
        return n2.value;
  }
}, worker: function(e2) {
  const t2 = URL.createObjectURL(new Blob([e2], { type: "text/javascript" })), n2 = new Worker(t2);
  return he(n2, () => {
    n2.terminate(), URL.revokeObjectURL(t2);
  });
} };
function ve(e2, t2) {
  return function(n2) {
    var r2, o2, i2, a2, s2, u2, l2, c2, f2 = n2[0], d2 = [], h2 = null, m2 = -1;
    for (s2 = 1, u2 = arguments.length; s2 < u2; ++s2) {
      if ((r2 = arguments[s2]) instanceof Node)
        d2[++m2] = r2, f2 += "<!--o:" + m2 + "-->";
      else if (Array.isArray(r2)) {
        for (l2 = 0, c2 = r2.length; l2 < c2; ++l2)
          (o2 = r2[l2]) instanceof Node ? (h2 === null && (d2[++m2] = h2 = document.createDocumentFragment(), f2 += "<!--o:" + m2 + "-->"), h2.appendChild(o2)) : (h2 = null, f2 += o2);
        h2 = null;
      } else
        f2 += r2;
      f2 += n2[s2];
    }
    if (h2 = e2(f2), ++m2 > 0) {
      for (i2 = new Array(m2), a2 = document.createTreeWalker(h2, NodeFilter.SHOW_COMMENT, null, false); a2.nextNode(); )
        o2 = a2.currentNode, /^o:/.test(o2.nodeValue) && (i2[+o2.nodeValue.slice(2)] = o2);
      for (s2 = 0; s2 < m2; ++s2)
        (o2 = i2[s2]) && o2.parentNode.replaceChild(d2[s2], o2);
    }
    return h2.childNodes.length === 1 ? h2.removeChild(h2.firstChild) : h2.nodeType === 11 ? ((o2 = t2()).appendChild(h2), o2) : h2;
  };
}
var ye = ve(function(e2) {
  var t2 = document.createElement("template");
  return t2.innerHTML = e2.trim(), document.importNode(t2.content, true);
}, function() {
  return document.createElement("span");
});
function ge(e2) {
  let t2;
  Object.defineProperties(this, { generator: { value: me((e3) => {
    t2 = e3;
  }) }, value: { get: () => e2, set: (n2) => t2(e2 = n2) } }), e2 !== void 0 && t2(e2);
}
function* be() {
  for (; ; )
    yield Date.now();
}
var xe = new Map();
function je(e2, t2) {
  var n2;
  return (n2 = xe.get(e2 = +e2)) ? n2.then(() => t2) : (n2 = Date.now()) >= e2 ? Promise.resolve(t2) : function(e3, t3) {
    var n3 = new Promise(function(n4) {
      xe.delete(t3);
      var r2 = t3 - e3;
      if (!(r2 > 0))
        throw new Error("invalid time");
      if (r2 > 2147483647)
        throw new Error("too long to wait");
      setTimeout(n4, r2);
    });
    return xe.set(t3, n3), n3;
  }(n2, e2).then(() => t2);
}
var Ee = { delay: function(e2, t2) {
  return new Promise(function(n2) {
    setTimeout(function() {
      n2(t2);
    }, e2);
  });
}, tick: function(e2, t2) {
  return je(Math.ceil((Date.now() + 1) / e2) * e2, t2);
}, when: je };
function Pe(e2, t2) {
  if (/^(\w+:)|\/\//i.test(e2))
    return e2;
  if (/^[.]{0,2}\//i.test(e2))
    return new URL(e2, t2 == null ? location : t2).href;
  if (!e2.length || /^[\s._]/.test(e2) || /\s$/.test(e2))
    throw new Error("illegal name");
  return "https://unpkg.com/" + e2;
}
function Ce(e2) {
  return e2 == null ? N : L(e2);
}
var Ae = ve(function(e2) {
  var t2 = document.createElementNS("http://www.w3.org/2000/svg", "g");
  return t2.innerHTML = e2.trim(), t2;
}, function() {
  return document.createElementNS("http://www.w3.org/2000/svg", "g");
});
var Ne = String.raw;
function Le() {
  return me(function(e2) {
    var t2 = e2(document.body.clientWidth);
    function n2() {
      var n3 = document.body.clientWidth;
      n3 !== t2 && e2(t2 = n3);
    }
    return window.addEventListener("resize", n2), function() {
      window.removeEventListener("resize", n2);
    };
  });
}
var Oe = Object.assign(function(e2) {
  const t2 = Ce(e2);
  var n2;
  Object.defineProperties(this, (n2 = { FileAttachment: () => ie, Arrow: () => t2(V.resolve()), Inputs: () => t2(q.resolve()), Mutable: () => ge, Plot: () => t2(M.resolve()), SQLite: () => G(t2), SQLiteDatabaseClient: () => SQLiteDatabaseClient, _: () => t2(F.resolve()), aq: () => t2.alias({ "apache-arrow": V.resolve() })(J.resolve()), d3: () => t2(U.resolve()), dot: () => t2(S.resolve()), htl: () => t2(B.resolve()), html: () => ye, md: () => function(e3) {
    return e3(H.resolve()).then(function(t3) {
      return ve(function(n3) {
        var r2 = document.createElement("div");
        r2.innerHTML = t3(n3, { langPrefix: "" }).trim();
        var o2 = r2.querySelectorAll("pre code[class]");
        return o2.length > 0 && e3(_.resolve()).then(function(t4) {
          o2.forEach(function(n4) {
            function r3() {
              t4.highlightBlock(n4), n4.parentNode.classList.add("observablehq--md-pre");
            }
            t4.getLanguage(n4.className) ? r3() : e3(_.resolve("async-languages/index.js")).then((r4) => {
              if (r4.has(n4.className))
                return e3(_.resolve("async-languages/" + r4.get(n4.className))).then((e4) => {
                  t4.registerLanguage(n4.className, e4);
                });
            }).then(r3, r3);
          });
        }), r2;
      }, function() {
        return document.createElement("div");
      });
    });
  }(t2), now: be, require: () => t2, resolve: () => Pe, svg: () => Ae, tex: () => function(e3) {
    return Promise.all([e3(D.resolve()), (t3 = D.resolve("dist/katex.min.css"), new Promise(function(e4, n3) {
      var r2 = document.createElement("link");
      r2.rel = "stylesheet", r2.href = t3, r2.onerror = n3, r2.onload = e4, document.head.appendChild(r2);
    }))]).then(function(e4) {
      var t4 = e4[0], n3 = r2();
      function r2(e5) {
        return function() {
          var n4 = document.createElement("div");
          return t4.render(Ne.apply(String, arguments), n4, e5), n4.removeChild(n4.firstChild);
        };
      }
      return n3.options = r2, n3.block = r2({ displayMode: true }), n3;
    });
    var t3;
  }(t2), topojson: () => t2(X.resolve()), vl: () => async function(e3) {
    const [t3, n3, r2] = await Promise.all([I, Z, Q].map((t4) => e3(t4.resolve())));
    return r2.register(t3, n3);
  }(t2), width: Le, DOM: ce, Files: fe, Generators: we, Promises: Ee }, Y(Object.entries(n2).map(Re))));
}, { resolve: N.resolve });
function Re([e2, t2]) {
  return [e2, { value: t2, writable: true, enumerable: true }];
}

// pandoc-code-decorator.js
var PandocCodeDecorator = class {
  constructor(node) {
    this._node = node;
    this._spans = [];
    this.normalizeCodeRange();
    this.initializeEntryPoints();
  }
  normalizeCodeRange() {
    const n2 = this._node;
    const lines = n2.querySelectorAll("code > span");
    for (const line of lines) {
      Array.from(line.childNodes).filter((n22) => n22.nodeType === n22.TEXT_NODE).forEach((n22) => {
        const newSpan = document.createElement("span");
        newSpan.textContent = n22.wholeText;
        n22.replaceWith(newSpan);
      });
    }
  }
  initializeEntryPoints() {
    const lines = this._node.querySelectorAll("code > span");
    let result = [];
    let offset = this._node.parentElement.dataset.sourceOffset && -Number(this._node.parentElement.dataset.sourceOffset) || 0;
    for (const line of lines) {
      let lineNumber = Number(line.id.split("-").pop());
      let column = 1;
      Array.from(line.childNodes).filter((n2) => n2.nodeType === n2.ELEMENT_NODE && n2.nodeName === "SPAN").forEach((n2) => {
        result.push({
          offset,
          line: lineNumber,
          column,
          node: n2
        });
        offset += n2.textContent.length;
        column += n2.textContent.length;
      });
      offset += 1;
    }
    this._elementEntryPoints = result;
  }
  locateEntry(offset) {
    let candidate;
    if (offset === Infinity)
      return void 0;
    for (let i2 = 0; i2 < this._elementEntryPoints.length; ++i2) {
      const entry = this._elementEntryPoints[i2];
      if (entry.offset > offset) {
        return { entry: candidate, index: i2 - 1 };
      }
      candidate = entry;
    }
    if (offset < candidate.offset + candidate.node.textContent.length) {
      return { entry: candidate, index: this._elementEntryPoints.length - 1 };
    } else {
      return void 0;
    }
  }
  offsetToLineColumn(offset) {
    let entry = this.locateEntry(offset);
    if (entry === void 0) {
      const entries = this._elementEntryPoints;
      const last = entries[entries.length - 1];
      return {
        line: last.line,
        column: last.column + Math.min(last.node.textContent.length, offset - last.offset)
      };
    }
    return {
      line: entry.entry.line,
      column: entry.entry.column + offset - entry.entry.offset
    };
  }
  *spanSelection(start, end) {
    this.ensureExactSpan(start, end);
    const startEntry = this.locateEntry(start);
    const endEntry = this.locateEntry(end);
    if (startEntry === void 0) {
      return;
    }
    const startIndex = startEntry.index;
    const endIndex = endEntry && endEntry.index || this._elementEntryPoints.length;
    for (let i2 = startIndex; i2 < endIndex; ++i2) {
      yield this._elementEntryPoints[i2];
    }
  }
  decorateSpan(start, end, classes) {
    for (const entryPoint of this.spanSelection(start, end)) {
      for (const cssClass of classes) {
        entryPoint.node.classList.add(cssClass);
      }
    }
  }
  clearSpan(start, end, classes) {
    for (const entryPoint of this.spanSelection(start, end)) {
      for (const cssClass of classes) {
        entryPoint.node.classList.remove(cssClass);
      }
    }
  }
  ensureExactSpan(start, end) {
    const splitEntry = (entry, offset) => {
      const newSpan = document.createElement("span");
      for (const cssClass of entry.node.classList) {
        newSpan.classList.add(cssClass);
      }
      const beforeText = entry.node.textContent.slice(0, offset - entry.offset);
      const afterText = entry.node.textContent.slice(offset - entry.offset);
      entry.node.textContent = beforeText;
      newSpan.textContent = afterText;
      entry.node.after(newSpan);
      this._elementEntryPoints.push({
        column: entry.column + offset - entry.offset,
        line: entry.line,
        node: newSpan,
        offset
      });
      this._elementEntryPoints.sort((a2, b2) => a2.offset - b2.offset);
    };
    const startEntry = this.locateEntry(start);
    if (startEntry !== void 0 && startEntry.entry.offset != start) {
      splitEntry(startEntry.entry, start);
    }
    const endEntry = this.locateEntry(end);
    if (endEntry !== void 0 && endEntry.entry.offset !== end) {
      splitEntry(endEntry.entry, end);
    }
  }
  clearSpan(start, end, classes) {
    this.ensureExactSpan(start, end);
    const startEntry = this.locateEntry(start);
    const endEntry = this.locateEntry(end);
    if (startEntry === void 0) {
      return;
    }
    const startIndex = startEntry.index;
    const endIndex = endEntry && endEntry.index || this._elementEntryPoints.length;
    for (let i2 = startIndex; i2 < endIndex; ++i2) {
      for (const cssClass of classes) {
        this._elementEntryPoints[i2].node.classList.remove(cssClass);
      }
    }
  }
};

// quarto-observable-shiny.js
import {
  Inspector as Inspector2
} from "https://cdn.skypack.dev/@observablehq/runtime@4.18.3";
import {
  button
} from "https://cdn.skypack.dev/@observablehq/inputs@0.10.4";

// quarto-inspector.js
import {
  Inspector
} from "https://cdn.skypack.dev/@observablehq/runtime@4.18.3";
var QuartoInspector = class extends Inspector {
  constructor(node, cellAst) {
    super(node);
    this._cellAst = cellAst;
  }
  rejected(error) {
    return super.rejected(error);
  }
};

// quarto-observable-shiny.js
var shinyInputVars = new Set();
var shinyInitialValue = {};
function extendObservableStdlib(lib) {
  class NamedVariableOutputBinding extends Shiny.OutputBinding {
    constructor(name, change) {
      super();
      this._name = name;
      this._change = change;
    }
    find(scope) {
      return $(scope).find("#" + this._name);
    }
    getId(el) {
      return el.id;
    }
    renderValue(_el, data) {
      this._change(data);
    }
    onValueError(el, err) {
      const group = `Shiny error in ${el.id}`;
      console.groupCollapsed(`%c${group}`, "color:red");
      console.log(`${err.message}`);
      console.log(`call: ${err.call}`);
      console.groupEnd(group);
    }
  }
  $(document).on("shiny:connected", function(_event) {
    Object.entries(shinyInitialValue).map(([k2, v2]) => {
      window.Shiny.setInputValue(k2, v2);
    });
    shinyInitialValue = {};
  });
  lib.shinyInput = function() {
    return (name) => {
      shinyInputVars.add(name);
      window._ojs.ojsConnector.mainModule.value(name).then((val) => {
        if (window.Shiny && window.Shiny.setInputValue) {
          window.Shiny.setInputValue(name, val);
        } else {
          shinyInitialValue[name] = val;
        }
      });
    };
  };
  lib.shinyOutput = function() {
    return function(name) {
      const dummySpan = document.createElement("div");
      dummySpan.id = name;
      dummySpan.classList.add("ojs-variable-writer");
      window._ojs.shinyElementRoot.appendChild(dummySpan);
      return lib.Generators.observe((change) => {
        Shiny.outputBindings.register(new NamedVariableOutputBinding(name, change));
      });
    };
  };
}
var ShinyInspector = class extends QuartoInspector {
  constructor(node) {
    super(node);
  }
  fulfilled(value, name) {
    if (shinyInputVars.has(name) && window.Shiny) {
      if (window.Shiny.setInputValue === void 0) {
        shinyInitialValue[name] = value;
      } else {
        window.Shiny.setInputValue(name, value);
      }
    }
    return super.fulfilled(value, name);
  }
};
var { Generators } = new Oe();
var OjsButtonInput = class {
  find(_scope) {
    return document.querySelectorAll(".ojs-inputs-button");
  }
  init(el, change) {
    const btn = button(el.textContent);
    el.innerHTML = "";
    el.appendChild(btn);
    const obs = Generators.input(el.firstChild);
    (async function() {
      await obs.next().value;
      for (const x2 of obs) {
        change(await x2);
      }
    })();
    return {
      onSetValue: (_value) => {
      },
      dispose: () => {
        obs.return();
      }
    };
  }
};
function initOjsShinyRuntime() {
  const valueSym = Symbol("value");
  const callbackSym = Symbol("callback");
  const instanceSym = Symbol("instance");
  class BindingAdapter extends Shiny.InputBinding {
    constructor(x2) {
      super();
      this.x = x2;
    }
    find(scope) {
      const matches = this.x.find(scope);
      return $(matches);
    }
    getId(el) {
      if (this.x.getId) {
        return this.x.getId(el);
      } else {
        return super.getId(el);
      }
    }
    initialize(el) {
      const changeHandler = (value) => {
        el[valueSym] = value;
        el[callbackSym]();
      };
      const instance = this.x.init(el, changeHandler);
      el[instanceSym] = instance;
    }
    getValue(el) {
      return el[valueSym];
    }
    setValue(el, value) {
      el[valueSym] = value;
      el[instanceSym].onSetValue(value);
    }
    subscribe(el, callback) {
      el[callbackSym] = callback;
    }
    unsubscribe(el) {
      el[instanceSym].dispose();
    }
  }
  class InspectorOutputBinding extends Shiny.OutputBinding {
    find(scope) {
      return $(scope).find(".observablehq-inspector");
    }
    getId(el) {
      return el.id;
    }
    renderValue(el, data) {
      new Inspector2(el).fulfilled(data);
    }
  }
  if (window.Shiny === void 0) {
    console.warn("Shiny runtime not found; Shiny features won't work.");
    return false;
  }
  Shiny.inputBindings.register(new BindingAdapter(new OjsButtonInput()));
  Shiny.outputBindings.register(new InspectorOutputBinding());
  Shiny.addCustomMessageHandler("ojs-export", ({ name }) => {
    window._ojs.ojsConnector.mainModule.redefine(name, window._ojs.ojsConnector.library.shinyOutput()(name));
    Shiny.bindAll(document.body);
  });
  return true;
}

// ojs-connector.js
import {
  Interpreter
} from "https://cdn.skypack.dev/@alex.garcia/unofficial-observablehq-compiler@0.6.0-alpha.9";
import {
  Inspector as Inspector3,
  Runtime,
  RuntimeError
} from "https://cdn.skypack.dev/@observablehq/runtime@4.18.3";

// observablehq-parser.js
import { getLineInfo, TokContext, tokTypes as tt, Parser } from "https://cdn.skypack.dev/acorn@7";
import { ancestor } from "https://cdn.skypack.dev/acorn-walk@7";
import { make } from "https://cdn.skypack.dev/acorn-walk@7";
import { simple } from "https://cdn.skypack.dev/acorn-walk@7";
var globals_default = new Set([
  "Array",
  "ArrayBuffer",
  "atob",
  "AudioContext",
  "Blob",
  "Boolean",
  "BigInt",
  "btoa",
  "clearInterval",
  "clearTimeout",
  "console",
  "crypto",
  "CustomEvent",
  "DataView",
  "Date",
  "decodeURI",
  "decodeURIComponent",
  "devicePixelRatio",
  "document",
  "encodeURI",
  "encodeURIComponent",
  "Error",
  "escape",
  "eval",
  "fetch",
  "File",
  "FileList",
  "FileReader",
  "Float32Array",
  "Float64Array",
  "Function",
  "Headers",
  "Image",
  "ImageData",
  "Infinity",
  "Int16Array",
  "Int32Array",
  "Int8Array",
  "Intl",
  "isFinite",
  "isNaN",
  "JSON",
  "Map",
  "Math",
  "NaN",
  "Number",
  "navigator",
  "Object",
  "parseFloat",
  "parseInt",
  "performance",
  "Path2D",
  "Promise",
  "Proxy",
  "RangeError",
  "ReferenceError",
  "Reflect",
  "RegExp",
  "cancelAnimationFrame",
  "requestAnimationFrame",
  "Set",
  "setInterval",
  "setTimeout",
  "String",
  "Symbol",
  "SyntaxError",
  "TextDecoder",
  "TextEncoder",
  "this",
  "TypeError",
  "Uint16Array",
  "Uint32Array",
  "Uint8Array",
  "Uint8ClampedArray",
  "undefined",
  "unescape",
  "URIError",
  "URL",
  "WeakMap",
  "WeakSet",
  "WebSocket",
  "Worker",
  "window"
]);
var walk_default = make({
  Import() {
  },
  ViewExpression(node, st, c2) {
    c2(node.id, st, "Identifier");
  },
  MutableExpression(node, st, c2) {
    c2(node.id, st, "Identifier");
  }
});
function isScope(node) {
  return node.type === "FunctionExpression" || node.type === "FunctionDeclaration" || node.type === "ArrowFunctionExpression" || node.type === "Program";
}
function isBlockScope(node) {
  return node.type === "BlockStatement" || node.type === "ForInStatement" || node.type === "ForOfStatement" || node.type === "ForStatement" || isScope(node);
}
function declaresArguments(node) {
  return node.type === "FunctionExpression" || node.type === "FunctionDeclaration";
}
function findReferences(cell, globals) {
  const ast = { type: "Program", body: [cell.body] };
  const locals = new Map();
  const globalSet = new Set(globals);
  const references = [];
  function hasLocal(node, name) {
    const l2 = locals.get(node);
    return l2 ? l2.has(name) : false;
  }
  function declareLocal(node, id) {
    const l2 = locals.get(node);
    if (l2)
      l2.add(id.name);
    else
      locals.set(node, new Set([id.name]));
  }
  function declareClass(node) {
    if (node.id)
      declareLocal(node, node.id);
  }
  function declareFunction(node) {
    node.params.forEach((param) => declarePattern(param, node));
    if (node.id)
      declareLocal(node, node.id);
  }
  function declareCatchClause(node) {
    if (node.param)
      declarePattern(node.param, node);
  }
  function declarePattern(node, parent) {
    switch (node.type) {
      case "Identifier":
        declareLocal(parent, node);
        break;
      case "ObjectPattern":
        node.properties.forEach((node2) => declarePattern(node2, parent));
        break;
      case "ArrayPattern":
        node.elements.forEach((node2) => node2 && declarePattern(node2, parent));
        break;
      case "Property":
        declarePattern(node.value, parent);
        break;
      case "RestElement":
        declarePattern(node.argument, parent);
        break;
      case "AssignmentPattern":
        declarePattern(node.left, parent);
        break;
      default:
        throw new Error("Unrecognized pattern type: " + node.type);
    }
  }
  function declareModuleSpecifier(node) {
    declareLocal(ast, node.local);
  }
  ancestor(ast, {
    VariableDeclaration: (node, parents) => {
      let parent = null;
      for (let i2 = parents.length - 1; i2 >= 0 && parent === null; --i2) {
        if (node.kind === "var" ? isScope(parents[i2]) : isBlockScope(parents[i2])) {
          parent = parents[i2];
        }
      }
      node.declarations.forEach((declaration) => declarePattern(declaration.id, parent));
    },
    FunctionDeclaration: (node, parents) => {
      let parent = null;
      for (let i2 = parents.length - 2; i2 >= 0 && parent === null; --i2) {
        if (isScope(parents[i2])) {
          parent = parents[i2];
        }
      }
      declareLocal(parent, node.id);
      declareFunction(node);
    },
    Function: declareFunction,
    ClassDeclaration: (node, parents) => {
      let parent = null;
      for (let i2 = parents.length - 2; i2 >= 0 && parent === null; i2--) {
        if (isScope(parents[i2])) {
          parent = parents[i2];
        }
      }
      declareLocal(parent, node.id);
    },
    Class: declareClass,
    CatchClause: declareCatchClause,
    ImportDefaultSpecifier: declareModuleSpecifier,
    ImportSpecifier: declareModuleSpecifier,
    ImportNamespaceSpecifier: declareModuleSpecifier
  }, walk_default);
  function identifier(node, parents) {
    let name = node.name;
    if (name === "undefined")
      return;
    for (let i2 = parents.length - 2; i2 >= 0; --i2) {
      if (name === "arguments") {
        if (declaresArguments(parents[i2])) {
          return;
        }
      }
      if (hasLocal(parents[i2], name)) {
        return;
      }
      if (parents[i2].type === "ViewExpression") {
        node = parents[i2];
        name = `viewof ${node.id.name}`;
      }
      if (parents[i2].type === "MutableExpression") {
        node = parents[i2];
        name = `mutable ${node.id.name}`;
      }
    }
    if (!globalSet.has(name)) {
      if (name === "arguments") {
        throw Object.assign(new SyntaxError(`arguments is not allowed`), { node });
      }
      references.push(node);
    }
  }
  ancestor(ast, {
    VariablePattern: identifier,
    Identifier: identifier
  }, walk_default);
  function checkConst(node, parents) {
    if (!node)
      return;
    switch (node.type) {
      case "Identifier":
      case "VariablePattern": {
        for (const parent of parents) {
          if (hasLocal(parent, node.name)) {
            return;
          }
        }
        if (parents[parents.length - 2].type === "MutableExpression") {
          return;
        }
        throw Object.assign(new SyntaxError(`Assignment to constant variable ${node.name}`), { node });
      }
      case "ArrayPattern": {
        for (const element of node.elements) {
          checkConst(element, parents);
        }
        return;
      }
      case "ObjectPattern": {
        for (const property of node.properties) {
          checkConst(property, parents);
        }
        return;
      }
      case "Property": {
        checkConst(node.value, parents);
        return;
      }
      case "RestElement": {
        checkConst(node.argument, parents);
        return;
      }
    }
  }
  function checkConstArgument(node, parents) {
    checkConst(node.argument, parents);
  }
  function checkConstLeft(node, parents) {
    checkConst(node.left, parents);
  }
  ancestor(ast, {
    AssignmentExpression: checkConstLeft,
    AssignmentPattern: checkConstLeft,
    UpdateExpression: checkConstArgument,
    ForOfStatement: checkConstLeft,
    ForInStatement: checkConstLeft
  }, walk_default);
  return references;
}
function findFeatures(cell, featureName) {
  const ast = { type: "Program", body: [cell.body] };
  const features = new Map();
  const { references } = cell;
  simple(ast, {
    CallExpression: (node) => {
      const { callee, arguments: args } = node;
      if (callee.type !== "Identifier" || callee.name !== featureName || references.indexOf(callee) < 0)
        return;
      if (args.length !== 1 || !(args[0].type === "Literal" && /^['"]/.test(args[0].raw) || args[0].type === "TemplateLiteral" && args[0].expressions.length === 0)) {
        throw Object.assign(new SyntaxError(`${featureName} requires a single literal string argument`), { node });
      }
      const [arg] = args;
      const name = arg.type === "Literal" ? arg.value : arg.quasis[0].value.cooked;
      const location2 = { start: arg.start, end: arg.end };
      if (features.has(name))
        features.get(name).push(location2);
      else
        features.set(name, [location2]);
    }
  }, walk_default);
  return features;
}
var SCOPE_FUNCTION = 2;
var SCOPE_ASYNC = 4;
var SCOPE_GENERATOR = 8;
var STATE_START = Symbol("start");
var STATE_MODIFIER = Symbol("modifier");
var STATE_FUNCTION = Symbol("function");
var STATE_NAME = Symbol("name");
var CellParser = class extends Parser {
  constructor(options, ...args) {
    super(Object.assign({ ecmaVersion: 12 }, options), ...args);
  }
  enterScope(flags) {
    if (flags & SCOPE_FUNCTION)
      ++this.O_function;
    return super.enterScope(flags);
  }
  exitScope() {
    if (this.currentScope().flags & SCOPE_FUNCTION)
      --this.O_function;
    return super.exitScope();
  }
  parseForIn(node, init) {
    if (this.O_function === 1 && node.await)
      this.O_async = true;
    return super.parseForIn(node, init);
  }
  parseAwait() {
    if (this.O_function === 1)
      this.O_async = true;
    return super.parseAwait();
  }
  parseYield(noIn) {
    if (this.O_function === 1)
      this.O_generator = true;
    return super.parseYield(noIn);
  }
  parseImport(node) {
    this.next();
    node.specifiers = this.parseImportSpecifiers();
    if (this.type === tt._with) {
      this.next();
      node.injections = this.parseImportSpecifiers();
    }
    this.expectContextual("from");
    node.source = this.type === tt.string ? this.parseExprAtom() : this.unexpected();
    return this.finishNode(node, "ImportDeclaration");
  }
  parseImportSpecifiers() {
    const nodes = [];
    const identifiers = new Set();
    let first = true;
    this.expect(tt.braceL);
    while (!this.eat(tt.braceR)) {
      if (first) {
        first = false;
      } else {
        this.expect(tt.comma);
        if (this.afterTrailingComma(tt.braceR))
          break;
      }
      const node = this.startNode();
      node.view = this.eatContextual("viewof");
      node.mutable = node.view ? false : this.eatContextual("mutable");
      node.imported = this.parseIdent();
      this.checkUnreserved(node.imported);
      this.checkLocal(node.imported);
      if (this.eatContextual("as")) {
        node.local = this.parseIdent();
        this.checkUnreserved(node.local);
        this.checkLocal(node.local);
      } else {
        node.local = node.imported;
      }
      this.checkLVal(node.local, "let");
      if (identifiers.has(node.local.name)) {
        this.raise(node.local.start, `Identifier '${node.local.name}' has already been declared`);
      }
      identifiers.add(node.local.name);
      nodes.push(this.finishNode(node, "ImportSpecifier"));
    }
    return nodes;
  }
  parseExprAtom(refDestructuringErrors) {
    return this.parseMaybeKeywordExpression("viewof", "ViewExpression") || this.parseMaybeKeywordExpression("mutable", "MutableExpression") || super.parseExprAtom(refDestructuringErrors);
  }
  startCell() {
    this.O_function = 0;
    this.O_async = false;
    this.O_generator = false;
    this.strict = true;
    this.enterScope(SCOPE_FUNCTION | SCOPE_ASYNC | SCOPE_GENERATOR);
  }
  finishCell(node, body, id) {
    if (id)
      this.checkLocal(id);
    node.id = id;
    node.body = body;
    node.async = this.O_async;
    node.generator = this.O_generator;
    this.exitScope();
    return this.finishNode(node, "Cell");
  }
  parseCell(node, eof) {
    const lookahead = new CellParser({}, this.input, this.start);
    let token = lookahead.getToken();
    let body = null;
    let id = null;
    this.startCell();
    if (token.type === tt._import && lookahead.getToken().type !== tt.parenL) {
      body = this.parseImport(this.startNode());
    } else if (token.type !== tt.eof && token.type !== tt.semi) {
      if (token.type === tt.name) {
        if (token.value === "viewof" || token.value === "mutable") {
          token = lookahead.getToken();
          if (token.type !== tt.name) {
            lookahead.unexpected();
          }
        }
        token = lookahead.getToken();
        if (token.type === tt.eq) {
          id = this.parseMaybeKeywordExpression("viewof", "ViewExpression") || this.parseMaybeKeywordExpression("mutable", "MutableExpression") || this.parseIdent();
          token = lookahead.getToken();
          this.expect(tt.eq);
        }
      }
      if (token.type === tt.braceL) {
        body = this.parseBlock();
      } else {
        body = this.parseExpression();
        if (id === null && (body.type === "FunctionExpression" || body.type === "ClassExpression")) {
          id = body.id;
        }
      }
    }
    this.semicolon();
    if (eof)
      this.expect(tt.eof);
    return this.finishCell(node, body, id);
  }
  parseTopLevel(node) {
    return this.parseCell(node, true);
  }
  toAssignable(node, isBinding, refDestructuringErrors) {
    return node.type === "MutableExpression" ? node : super.toAssignable(node, isBinding, refDestructuringErrors);
  }
  checkLocal(id) {
    const node = id.id || id;
    if (globals_default.has(node.name) || node.name === "arguments") {
      this.raise(node.start, `Identifier '${node.name}' is reserved`);
    }
  }
  checkUnreserved(node) {
    if (node.name === "viewof" || node.name === "mutable") {
      this.raise(node.start, `Unexpected keyword '${node.name}'`);
    }
    return super.checkUnreserved(node);
  }
  checkLVal(expr, bindingType, checkClashes) {
    return super.checkLVal(expr.type === "MutableExpression" ? expr.id : expr, bindingType, checkClashes);
  }
  unexpected(pos) {
    this.raise(pos != null ? pos : this.start, this.type === tt.eof ? "Unexpected end of input" : "Unexpected token");
  }
  parseMaybeKeywordExpression(keyword, type) {
    if (this.isContextual(keyword)) {
      const node = this.startNode();
      this.next();
      node.id = this.parseIdent();
      return this.finishNode(node, type);
    }
  }
};
var o_tmpl = new TokContext("`", true, true, (parser) => readTemplateToken.call(parser));
function readTemplateToken() {
  out:
    for (; this.pos < this.input.length; this.pos++) {
      switch (this.input.charCodeAt(this.pos)) {
        case 92: {
          if (this.pos < this.input.length - 1)
            ++this.pos;
          break;
        }
        case 36: {
          if (this.input.charCodeAt(this.pos + 1) === 123) {
            if (this.pos === this.start && this.type === tt.invalidTemplate) {
              this.pos += 2;
              return this.finishToken(tt.dollarBraceL);
            }
            break out;
          }
          break;
        }
      }
    }
  return this.finishToken(tt.invalidTemplate, this.input.slice(this.start, this.pos));
}
function parseModule(input, { globals } = {}) {
  const program = ModuleParser.parse(input);
  for (const cell of program.cells) {
    parseReferences(cell, input, globals);
    parseFeatures(cell, input, globals);
  }
  return program;
}
var ModuleParser = class extends CellParser {
  parseTopLevel(node) {
    if (!node.cells)
      node.cells = [];
    while (this.type !== tt.eof) {
      const cell = this.parseCell(this.startNode());
      cell.input = this.input;
      node.cells.push(cell);
    }
    this.next();
    return this.finishNode(node, "Program");
  }
};
function parseReferences(cell, input, globals = globals_default) {
  if (!cell.body) {
    cell.references = [];
  } else if (cell.body.type === "ImportDeclaration") {
    cell.references = cell.body.injections ? cell.body.injections.map((i2) => i2.imported) : [];
  } else {
    try {
      cell.references = findReferences(cell, globals);
    } catch (error) {
      if (error.node) {
        const loc = getLineInfo(input, error.node.start);
        error.message += ` (${loc.line}:${loc.column})`;
        error.pos = error.node.start;
        error.loc = loc;
        delete error.node;
      }
      throw error;
    }
  }
  return cell;
}
function parseFeatures(cell, input) {
  if (cell.body && cell.body.type !== "ImportDeclaration") {
    try {
      cell.fileAttachments = findFeatures(cell, "FileAttachment");
      cell.databaseClients = findFeatures(cell, "DatabaseClient");
      cell.secrets = findFeatures(cell, "Secret");
    } catch (error) {
      if (error.node) {
        const loc = getLineInfo(input, error.node.start);
        error.message += ` (${loc.line}:${loc.column})`;
        error.pos = error.node.start;
        error.loc = loc;
        delete error.node;
      }
      throw error;
    }
  } else {
    cell.fileAttachments = new Map();
    cell.databaseClients = new Map();
    cell.secrets = new Map();
  }
  return cell;
}

// ojs-connector.js
var EmptyInspector = class {
  pending() {
  }
  fulfilled(_value, _name) {
  }
  rejected(_error, _name) {
  }
};
function es6ImportAsObservableModule(m2) {
  return function(runtime, observer) {
    const main = runtime.module();
    Object.keys(m2).forEach((key) => {
      const v2 = m2[key];
      main.variable(observer(key)).define(key, [], () => v2);
    });
    return main;
  };
}
async function defaultResolveImportPath(path) {
  const extractPath = (path2) => {
    let source2 = path2;
    let m3;
    if (m3 = /\.js(\?|$)/i.exec(source2)) {
      source2 = source2.slice(0, m3.index);
    }
    if (m3 = /^[0-9a-f]{16}$/i.test(source2)) {
      source2 = `d/${source2}`;
    }
    if (m3 = /^https:\/\/(api\.|beta\.|)observablehq\.com\//i.exec(source2)) {
      source2 = source2.slice(m3[0].length);
    }
    return source2;
  };
  const source = extractPath(path);
  const metadataURL = `https://api.observablehq.com/document/${source}`;
  const moduleURL = `https://api.observablehq.com/${source}.js?v=3`;
  const m2 = await import(moduleURL);
  return m2.default;
}
function importPathResolver(paths, localResolverMap) {
  function importRootPath(path) {
    const { runtimeToRoot } = paths;
    if (!runtimeToRoot) {
      return path;
    } else {
      return `${runtimeToRoot}/${path}`;
    }
  }
  function importRelativePath(path) {
    const { runtimeToDoc } = paths;
    if (!runtimeToDoc) {
      return path;
    } else {
      return `${runtimeToDoc}/${path}`;
    }
  }
  function fetchRootPath(path) {
    const { docToRoot } = paths;
    if (!docToRoot) {
      return path;
    } else {
      return `${docToRoot}/${path}`;
    }
  }
  function fetchRelativePath(path) {
    return path;
  }
  return async (path) => {
    const isLocalModule = path.startsWith("/") || path.startsWith(".");
    const isImportFromObservableWebsite = path.match(/^https:\/\/(api\.|beta\.|)observablehq\.com\//i);
    if (!isLocalModule || isImportFromObservableWebsite) {
      return defaultResolveImportPath(path);
    }
    let importPath, fetchPath;
    let moduleType;
    if (window._ojs.selfContained) {
      const resolved = localResolverMap.get(path);
      if (resolved === void 0) {
        throw new Error(`missing local file ${path} in self-contained mode`);
      }
      importPath = resolved;
      fetchPath = resolved;
      const mimeType = resolved.match(/data:(.*);base64/)[1];
      switch (mimeType) {
        case "application/javascript":
          moduleType = "js";
          break;
        case "application/ojs-javascript":
          moduleType = "ojs";
          break;
        default:
          throw new Error(`unrecognized MIME type ${mimeType}`);
      }
    } else {
      const resourceURL = new URL(path, window.location);
      moduleType = resourceURL.pathname.match(/\.(ojs|js|qmd)$/)[1];
      if (path.startsWith("/")) {
        importPath = importRootPath(path);
        fetchPath = fetchRootPath(path);
      } else {
        importPath = importRelativePath(path);
        fetchPath = fetchRelativePath(path);
      }
    }
    if (moduleType === "js") {
      try {
        const m2 = await import(importPath);
        return es6ImportAsObservableModule(m2);
      } catch (e2) {
        console.error(e2);
        throw e2;
      }
    } else if (moduleType === "ojs") {
      return importOjsFromURL(fetchPath);
    } else if (moduleType === "qmd") {
      const htmlPath = `${fetchPath.slice(0, -4)}.html`;
      const response = await fetch(htmlPath);
      const text = await response.text();
      return createOjsModuleFromHTMLSrc(text);
    } else {
      throw new Error(`internal error, unrecognized module type ${moduleType}`);
    }
  };
}
function createOjsModuleFromHTMLSrc(text) {
  const parser = new DOMParser();
  const doc = parser.parseFromString(text, "text/html");
  const staticDefns = [];
  for (const el of doc.querySelectorAll('script[type="ojs-define"]')) {
    staticDefns.push(el.text);
  }
  const ojsSource = [];
  for (const content of doc.querySelectorAll('script[type="ojs-module-contents"]')) {
    for (const cell of JSON.parse(content.text).contents) {
      ojsSource.push(cell.source);
    }
  }
  return createOjsModuleFromSrc(ojsSource.join("\n"), staticDefns);
}
function createOjsModuleFromSrc(src, staticDefns = []) {
  return (runtime, _observer) => {
    const newModule = runtime.module();
    const interpreter = window._ojs.ojsConnector.interpreter;
    const _cells = interpreter.module(src, newModule, (_name) => new EmptyInspector());
    for (const defn of staticDefns) {
      for (const { name, value } of JSON.parse(defn).contents) {
        window._ojs.ojsConnector.define(name, newModule)(value);
      }
    }
    return newModule;
  };
}
async function importOjsFromURL(path) {
  const r2 = await fetch(path);
  const src = await r2.text();
  return createOjsModuleFromSrc(src);
}
var OJSConnector = class {
  constructor({ paths, inspectorClass, library, allowPendingGlobals = false }) {
    this.library = library || new Oe();
    this.localResolverMap = new Map();
    this.pendingGlobals = {};
    this.allowPendingGlobals = allowPendingGlobals;
    this.runtime = new Runtime(this.library, (name) => this.global(name));
    this.mainModule = this.runtime.module();
    this.interpreter = new Interpreter({
      module: this.mainModule,
      resolveImportPath: importPathResolver(paths, this.localResolverMap)
    });
    this.inspectorClass = inspectorClass || Inspector3;
    this.mainModuleHasImports = false;
    this.mainModuleOutstandingImportCount = 0;
    this.chunkPromises = [];
  }
  global(name) {
    if (typeof window[name] !== "undefined") {
      return window[name];
    }
    if (!this.allowPendingGlobals) {
      return void 0;
    }
    if (!this.pendingGlobals.hasOwnProperty(name)) {
      const info = {};
      info.promise = new Promise((resolve, reject) => {
        info.resolve = resolve;
        info.reject = reject;
      });
      this.pendingGlobals[name] = info;
    }
    return this.pendingGlobals[name].promise;
  }
  killPendingGlobals() {
    this.allowPendingGlobals = false;
    for (const [name, { reject }] of Object.entries(this.pendingGlobals)) {
      reject(new RuntimeError(`${name} is not defined`));
    }
  }
  setLocalResolver(map) {
    for (const [key, value] of Object.entries(map)) {
      this.localResolverMap.set(key, value);
    }
  }
  define(name, module = void 0) {
    if (!module) {
      module = this.mainModule;
    }
    let change;
    const obs = this.library.Generators.observe((change_) => {
      change = change_;
    });
    module.variable().define(name, obs);
    return change;
  }
  watch(name, k2, module = void 0) {
    if (!module) {
      module = this.mainModule;
    }
    module.variable({
      fulfilled: (x2) => k2(x2, name)
    }).define([name], (val) => val);
  }
  async value(val, module = void 0) {
    if (!module) {
      module = this.mainModule;
    }
    const result = await module.value(val);
    return result;
  }
  finishInterpreting() {
    return Promise.all(this.chunkPromises);
  }
  interpretWithRunner(src, runner) {
    try {
      const parse = parseModule(src);
      const chunkPromise = Promise.all(parse.cells.map(runner));
      this.chunkPromises.push(chunkPromise);
      return chunkPromise;
    } catch (error) {
      return Promise.reject(error);
    }
  }
  waitOnImports(cell, promise) {
    if (cell.body.type !== "ImportDeclaration") {
      return promise;
    } else {
      this.mainModuleHasImports = true;
      this.mainModuleOutstandingImportCount++;
      return promise.then((result) => {
        this.mainModuleOutstandingImportCount--;
        if (this.mainModuleOutstandingImportCount === 0) {
          this.clearImportModuleWait();
        }
        return result;
      });
    }
  }
  interpretQuiet(src) {
    const runCell = (cell) => {
      const cellSrc = src.slice(cell.start, cell.end);
      const promise = this.interpreter.module(cellSrc, void 0, (_name) => new EmptyInspector());
      return this.waitOnImports(cell, promise);
    };
    return this.interpretWithRunner(src, runCell);
  }
};

// quarto-ojs.js
var makeDevhostErrorClickHandler = (line, column) => {
  return function() {
    if (!window.quartoDevhost) {
      return false;
    }
    window.quartoDevhost.openInputFile(line, column, true);
    return false;
  };
};
if (Object.fromEntries === void 0) {
  Object.fromEntries = function(obj) {
    const result = {};
    for (const [key, value] of obj) {
      result[key] = value;
    }
    return result;
  };
}
function calloutBlock(opts) {
  const { type, heading, message, onclick } = opts;
  const outerBlock = document.createElement("div");
  outerBlock.classList.add(`callout-${type}`, "callout", "callout-style-default", "callout-captioned");
  const header = document.createElement("div");
  header.classList.add("callout-header", "d-flex", "align-content-center");
  const iconContainer = document.createElement("div");
  iconContainer.classList.add("callout-icon-container");
  const icon = document.createElement("i");
  icon.classList.add("callout-icon");
  iconContainer.appendChild(icon);
  header.appendChild(iconContainer);
  const headingDiv = document.createElement("div");
  headingDiv.classList.add("callout-caption-container", "flex-fill");
  if (typeof heading === "string") {
    headingDiv.innerText = heading;
  } else {
    headingDiv.appendChild(heading);
  }
  header.appendChild(headingDiv);
  outerBlock.appendChild(header);
  const container = document.createElement("div");
  container.classList.add("callout-body-container", "callout-body");
  if (typeof message === "string") {
    const p2 = document.createElement("p");
    p2.innerText = message;
    container.appendChild(p2);
  } else {
    container.append(message);
  }
  outerBlock.appendChild(container);
  if (onclick) {
    outerBlock.onclick = onclick;
    outerBlock.style.cursor = "pointer";
  }
  return outerBlock;
}
var kQuartoModuleWaitClass = "ojs-in-a-box-waiting-for-module-import";
var QuartoOJSConnector = class extends OJSConnector {
  constructor(opts) {
    super(opts);
  }
  clearImportModuleWait() {
    const array = Array.from(document.querySelectorAll(`.${kQuartoModuleWaitClass}`));
    for (const node of array) {
      node.classList.remove(kQuartoModuleWaitClass);
    }
  }
  finishInterpreting() {
    return super.finishInterpreting().then(() => {
      if (this.mainModuleHasImports) {
        this.clearImportModuleWait();
      }
    });
  }
  locatePreDiv(cellDiv, ojsDiv) {
    let preDiv;
    for (const candidate of cellDiv.querySelectorAll("pre.sourceCode")) {
      if (candidate.compareDocumentPosition(ojsDiv) & ojsDiv.DOCUMENT_POSITION_FOLLOWING) {
        preDiv = candidate;
      } else {
        break;
      }
    }
    return preDiv;
  }
  findCellOutputDisplay(ojsDiv) {
    while (ojsDiv && !ojsDiv.classList.contains("cell-output-display")) {
      ojsDiv = ojsDiv.parentElement;
    }
    if (!ojsDiv) {
      throw new Error("Internal error: couldn't find output display div");
    }
    return ojsDiv;
  }
  setPreDivClasses(preDiv, hasErrors) {
    if (!hasErrors) {
      preDiv.classList.remove("numberSource");
      if (preDiv._hidden === true) {
        preDiv.parentElement.classList.add("hidden");
      }
    } else {
      preDiv.classList.add("numberSource");
      if (preDiv.parentElement.classList.contains("hidden")) {
        preDiv._hidden = true;
        preDiv.parentElement.classList.remove("hidden");
      }
    }
  }
  clearErrorPinpoints(cellDiv, ojsDiv) {
    const preDiv = this.locatePreDiv(cellDiv, ojsDiv);
    if (preDiv === void 0) {
      return;
    }
    this.setPreDivClasses(preDiv, false);
    let startingOffset = 0;
    if (preDiv.parentElement.dataset.sourceOffset) {
      startingOffset = -Number(preDiv.parentElement.dataset.sourceOffset);
    }
    for (const entryPoint of preDiv._decorator.spanSelection(startingOffset, Infinity)) {
      const { node } = entryPoint;
      node.classList.remove("quarto-ojs-error-pinpoint");
      node.onclick = null;
    }
  }
  decorateOjsDivWithErrorPinpoint(ojsDiv, start, end, line, column) {
    const cellOutputDisplay = this.findCellOutputDisplay(ojsDiv);
    if (cellOutputDisplay._errorSpans === void 0) {
      cellOutputDisplay._errorSpans = [];
    }
    cellOutputDisplay._errorSpans.push({
      start,
      end,
      line,
      column
    });
  }
  decorateSource(cellDiv, ojsDiv) {
    this.clearErrorPinpoints(cellDiv, ojsDiv);
    const preDiv = this.locatePreDiv(cellDiv, ojsDiv);
    if (preDiv === void 0) {
      return;
    }
    let div = preDiv.parentElement.nextElementSibling;
    let foundErrors = false;
    while (div !== null && div.classList.contains("cell-output-display")) {
      for (const errorSpan of div._errorSpans || []) {
        for (const entryPoint of preDiv._decorator.spanSelection(errorSpan.start, errorSpan.end)) {
          const { node } = entryPoint;
          node.classList.add("quarto-ojs-error-pinpoint");
          node.onclick = makeDevhostErrorClickHandler(errorSpan.line, errorSpan.column);
        }
        foundErrors = true;
      }
      div = div.nextElementSibling;
    }
    this.setPreDivClasses(preDiv, foundErrors);
  }
  clearError(ojsDiv) {
    const cellOutputDisplay = this.findCellOutputDisplay(ojsDiv);
    cellOutputDisplay._errorSpans = [];
  }
  signalError(cellDiv, ojsDiv, ojsAst) {
    const buildCallout = (ojsDiv2) => {
      let onclick;
      const inspectChild = ojsDiv2.querySelector(".observablehq--inspect");
      let [heading, message] = inspectChild.textContent.split(": ");
      if (heading === "RuntimeError") {
        heading = "OJS Runtime Error";
        if (message.match(/^(.+) is not defined$/)) {
          const [varName, ...rest] = message.split(" ");
          const p2 = document.createElement("p");
          const tt2 = document.createElement("tt");
          tt2.innerText = varName;
          p2.appendChild(tt2);
          p2.appendChild(document.createTextNode(" " + rest.join(" ")));
          message = p2;
          const preDiv = this.locatePreDiv(cellDiv, ojsDiv2);
          if (preDiv !== void 0) {
            preDiv.classList.add("numberSource");
            const missingRef = ojsAst.references.find((n2) => n2.name === varName);
            if (missingRef !== void 0) {
              const { line, column } = preDiv._decorator.offsetToLineColumn(missingRef.start);
              const headingSpan = document.createElement("span");
              const headingTextEl = document.createTextNode(`${heading} (line ${line}, column ${column}) `);
              headingSpan.appendChild(headingTextEl);
              if (window.quartoDevhost) {
                const clicker = document.createElement("a");
                clicker.href = "#";
                clicker.innerText = "(source)";
                onclick = makeDevhostErrorClickHandler(line, column);
                headingSpan.appendChild(clicker);
              }
              heading = headingSpan;
              this.decorateOjsDivWithErrorPinpoint(ojsDiv2, missingRef.start, missingRef.end, line, column);
            }
          }
        } else if (message.match(/^(.+) could not be resolved$/) || message.match(/^(.+) is defined more than once$/)) {
          const [varName, ...rest] = message.split(" ");
          const p2 = document.createElement("p");
          const tt2 = document.createElement("tt");
          tt2.innerText = varName;
          p2.appendChild(tt2);
          p2.appendChild(document.createTextNode(" " + rest.join(" ")));
          message = p2;
        } else if (message === "circular definition") {
          const p2 = document.createElement("p");
          p2.appendChild(document.createTextNode("circular definition"));
          message = p2;
        } else {
          throw new Error(`Internal error, could not parse OJS error message "${message}"`);
        }
      } else {
        heading = "OJS Error";
        const p2 = document.createElement("p");
        p2.appendChild(document.createTextNode(inspectChild.textContent));
        message = p2;
      }
      const callout = calloutBlock({
        type: "important",
        heading,
        message,
        onclick
      });
      ojsDiv2.appendChild(callout);
    };
    buildCallout(ojsDiv);
  }
  interpret(src, elementGetter, elementCreator) {
    const that = this;
    const observer = (targetElement, ojsAst) => {
      return (name) => {
        const element = typeof elementCreator === "function" ? elementCreator() : elementCreator;
        targetElement.appendChild(element);
        if (ojsAst.id && ojsAst.id.type === "ViewExpression" && !name.startsWith("viewof ")) {
          element.classList.add("quarto-ojs-hide");
        }
        let cellDiv = targetElement;
        let cellOutputDisplay;
        while (cellDiv !== null && !cellDiv.classList.contains("cell")) {
          cellDiv = cellDiv.parentElement;
          if (cellDiv && cellDiv.classList.contains("cell-output-display")) {
            cellOutputDisplay = cellDiv;
          }
        }
        const forceShowDeclarations = !(cellDiv && cellDiv.dataset.output !== "all");
        const config = { childList: true };
        const callback = function(mutationsList) {
          for (const mutation of mutationsList) {
            const ojsDiv = mutation.target;
            if (!forceShowDeclarations) {
              const childNodes = Array.from(mutation.target.childNodes);
              for (const n2 of childNodes) {
                if (n2.classList.contains("observablehq--inspect") && !n2.parentNode.classList.contains("observablehq--error") && n2.parentNode.parentNode.dataset.nodetype !== "expression") {
                  n2.classList.add("quarto-ojs-hide");
                }
                if (n2.classList.contains("observablehq--inspect") && !n2.parentNode.classList.contains("observablehq--error") && n2.parentNode.parentNode.dataset.nodetype === "expression") {
                  n2.classList.remove("quarto-ojs-hide");
                }
              }
            }
            if (ojsDiv.classList.contains("observablehq--error")) {
              ojsDiv.querySelector(".observablehq--inspect").style.display = "none";
              if (ojsDiv.querySelectorAll(".callout-important").length === 0) {
                that.signalError(cellDiv, ojsDiv, ojsAst);
              }
            } else {
              that.clearError(ojsDiv);
              if (ojsDiv.parentNode.dataset.nodetype !== "expression" && !forceShowDeclarations && Array.from(ojsDiv.childNodes).every((n2) => n2.classList.contains("observablehq--inspect"))) {
                ojsDiv.classList.add("quarto-ojs-hide");
              }
            }
            that.decorateSource(cellDiv, ojsDiv);
            for (const added of mutation.addedNodes) {
              if (added.tagName === "FORM" && Array.from(added.classList).some((x2) => x2.endsWith("table") && x2.startsWith("oi-"))) {
                added.classList.add("quarto-ojs-table-fixup");
              }
              const result = added.querySelectorAll("code.javascript");
              if (result.length !== 1) {
                continue;
              }
              if (result[0].textContent.trim().startsWith("import")) {
                ojsDiv.classList.add("quarto-ojs-hide");
              }
            }
          }
          if (cellOutputDisplay) {
            const children = Array.from(cellOutputDisplay.querySelectorAll("div.observablehq"));
            if (children.every((n2) => {
              return n2.classList.contains("quarto-ojs-hide");
            })) {
              cellOutputDisplay.classList.add("quarto-ojs-hide");
            } else {
              cellOutputDisplay.classList.remove("quarto-ojs-hide");
            }
          }
        };
        new MutationObserver(callback).observe(element, config);
        element.classList.add(kQuartoModuleWaitClass);
        return new this.inspectorClass(element, ojsAst);
      };
    };
    const runCell = (cell) => {
      const targetElement = typeof elementGetter === "function" ? elementGetter() : elementGetter;
      const cellSrc = src.slice(cell.start, cell.end);
      const promise = this.interpreter.module(cellSrc, void 0, observer(targetElement, cell));
      return this.waitOnImports(cell, promise);
    };
    return this.interpretWithRunner(src, runCell);
  }
};
function createRuntime() {
  const quartoOjsGlobal = window._ojs;
  const isShiny = window.Shiny !== void 0;
  if (isShiny) {
    quartoOjsGlobal.hasShiny = true;
    initOjsShinyRuntime();
    const span = document.createElement("span");
    window._ojs.shinyElementRoot = span;
    document.body.appendChild(span);
  }
  const lib = new Oe();
  if (isShiny) {
    extendObservableStdlib(lib);
  }
  function transpose(df) {
    const keys = Object.keys(df);
    return df[keys[0]].map((v2, i2) => Object.fromEntries(keys.map((key) => [key, df[key][i2] || void 0]))).filter((v2) => !Object.values(v2).every((e2) => e2 === void 0));
  }
  lib.transpose = () => transpose;
  const mainEl = document.querySelector("main");
  function width() {
    return lib.Generators.observe(function(change) {
      var width2 = change(mainEl.clientWidth);
      function resized() {
        var w2 = mainEl.clientWidth;
        if (w2 !== width2)
          change(width2 = w2);
      }
      window.addEventListener("resize", resized);
      return function() {
        window.removeEventListener("resize", resized);
      };
    });
  }
  lib.width = width;
  Array.from(document.querySelectorAll("span.co")).filter((n2) => n2.textContent === "//| echo: fenced").forEach((n2) => {
    const lineSpan = n2.parentElement;
    const lineBreak = lineSpan.nextSibling;
    if (lineBreak) {
      const nextLineSpan = lineBreak.nextSibling;
      if (nextLineSpan) {
        const lineNumber = Number(nextLineSpan.id.split("-")[1]);
        nextLineSpan.style = `counter-reset: source-line ${lineNumber - 1}`;
      }
    }
    const sourceDiv = lineSpan.parentElement.parentElement.parentElement;
    const oldOffset = Number(sourceDiv.dataset.sourceOffset);
    sourceDiv.dataset.sourceOffset = oldOffset - "//| echo: fenced\n".length;
    lineSpan.remove();
    lineBreak.remove();
  });
  const layoutDivs = Array.from(document.querySelectorAll("div.quarto-layout-panel div[id]"));
  function layoutWidth() {
    return lib.Generators.observe(function(change) {
      const ourWidths = Object.fromEntries(layoutDivs.map((div) => [div.id, div.clientWidth]));
      change(ourWidths);
      function resized() {
        let changed = false;
        for (const div of layoutDivs) {
          const w2 = div.clientWidth;
          if (w2 !== ourWidths[div.id]) {
            ourWidths[div.id] = w2;
            changed = true;
          }
        }
        if (changed) {
          change(ourWidths);
        }
      }
      window.addEventListener("resize", resized);
      return function() {
        window.removeEventListener("resize", resized);
      };
    });
  }
  lib.layoutWidth = layoutWidth;
  let localResolver = {};
  function fileAttachmentPathResolver(n2) {
    if (localResolver[n2]) {
      return localResolver[n2];
    }
    if (n2.startsWith("/")) {
      if (quartoOjsGlobal.paths.docToRoot === "") {
        return `.${n2}`;
      } else {
        return `${quartoOjsGlobal.paths.docToRoot}${n2}`;
      }
    } else {
      return n2;
    }
  }
  lib.FileAttachment = () => ae(fileAttachmentPathResolver);
  const ojsConnector = new QuartoOJSConnector({
    paths: quartoOjsGlobal.paths,
    inspectorClass: isShiny ? ShinyInspector : QuartoInspector,
    library: lib,
    allowPendingGlobals: isShiny
  });
  quartoOjsGlobal.ojsConnector = ojsConnector;
  if (isShiny) {
    $(document).one("shiny:idle", () => {
      $(document).one("shiny:message", () => {
        setTimeout(() => {
          ojsConnector.killPendingGlobals();
        }, 0);
      });
    });
  }
  const subfigIdMap = new Map();
  function getSubfigId(elementId) {
    if (!subfigIdMap.has(elementId)) {
      subfigIdMap.set(elementId, 0);
    }
    let nextIx = subfigIdMap.get(elementId);
    nextIx++;
    subfigIdMap.set(elementId, nextIx);
    return `${elementId}-${nextIx}`;
  }
  const sourceNodes = document.querySelectorAll("pre.sourceCode code.sourceCode");
  const decorators = Array.from(sourceNodes).map((n2) => {
    n2 = n2.parentElement;
    const decorator = new PandocCodeDecorator(n2);
    n2._decorator = decorator;
    return decorator;
  });
  decorators.forEach((n2) => {
    if (n2._node.parentElement.dataset.syntaxErrorPosition === void 0) {
      return;
    }
    const offset = Number(n2._node.parentElement.dataset.syntaxErrorPosition);
    n2.decorateSpan(offset, offset + 1, ["quarto-ojs-error-pinpoint"]);
  });
  const result = {
    setLocalResolver(obj) {
      localResolver = obj;
      ojsConnector.setLocalResolver(obj);
    },
    finishInterpreting() {
      return ojsConnector.finishInterpreting();
    },
    async value(name) {
      await this.finishInterpreting();
      const result2 = await ojsConnector.value(name);
      return result2;
    },
    interpretLenient(src, targetElementId, inline) {
      return result.interpret(src, targetElementId, inline).catch(() => {
      });
    },
    interpret(src, targetElementId, inline) {
      let targetElement;
      const getElement = () => {
        targetElement = document.getElementById(targetElementId);
        let subFigId;
        if (!targetElement) {
          subFigId = getSubfigId(targetElementId);
          targetElement = document.getElementById(subFigId);
          if (!targetElement) {
            throw new Error("Ran out of quarto subfigures.");
          }
        }
        return targetElement;
      };
      const makeElement = () => {
        return document.createElement(inline ? "span" : "div");
      };
      return ojsConnector.interpret(src, getElement, makeElement).catch((e2) => {
        let cellDiv = targetElement;
        while (cellDiv !== null && !cellDiv.classList.contains("cell")) {
          cellDiv = cellDiv.parentElement;
        }
        const ojsDiv = targetElement.querySelector(".observablehq");
        for (const div of ojsDiv.querySelectorAll(".callout")) {
          div.remove();
        }
        const messagePre = document.createElement("pre");
        messagePre.innerText = e2.stack;
        const callout = calloutBlock({
          type: "important",
          heading: `${e2.name}: ${e2.message}`,
          message: messagePre
        });
        ojsDiv.appendChild(callout);
        ojsConnector.clearError(ojsDiv);
        ojsConnector.clearErrorPinpoints(cellDiv, ojsDiv);
        return e2;
      });
    },
    interpretQuiet(src) {
      return ojsConnector.interpretQuiet(src);
    },
    interpretFromScriptTags() {
      for (const el of document.querySelectorAll("script[type='ojs-module-contents']")) {
        for (const call of JSON.parse(el.text).contents) {
          switch (call.methodName) {
            case "interpret":
              this.interpret(call.source, call.cellName, call.inline);
              break;
            case "interpretLenient":
              this.interpretLenient(call.source, call.cellName, call.inline);
              break;
            case "interpretQuiet":
              this.interpretQuiet(call.source);
              break;
            default:
              throw new Error(`Don't know how to call method ${call.methodName}`);
          }
        }
      }
      for (const el of document.querySelectorAll("script[type='ojs-define']")) {
        for (const { name, value } of JSON.parse(el.text).contents) {
          ojsConnector.define(name)(value);
        }
      }
    }
  };
  return result;
}
window._ojs = {
  ojsConnector: void 0,
  paths: {},
  hasShiny: false,
  shinyElementRoot: void 0
};
window._ojs.runtime = createRuntime();
export {
  createRuntime
};
</script>




<div class="cell">

</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This is the report of the analysis for project #5975, requested by Lisa Rydén (LU). For this study, targeted next generation sequencing by hybridization capture was performed to get data about a panel of approx 450 genes. The main aim of the analysis is to call somatic variants in a collection of 205 breast cancer samples; some of which are matched pairs of primary tumors and distance metastases or primary tumors and lymph node metastases. Matched normal samples are however not available but might be included later for more accurate results.</p>
<p>Contract:</p>
<ul>
<li>Preprocessing of 205 samples</li>
<li>CNV and SNV detection</li>
<li>Format data to allow for analysis of correlation with survival and clinical annotation</li>
<li>Detection of differences in CNV and SNV between primary tumors and lymph node or distant metastases</li>
<li>Correlation with tumor grouping and BC360 gene signatures based on Nanostring expression data</li>
</ul>
<p>[150 hours]</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the visualization in this report do not work as expected, you might have to update or change your browser. Please let me know if any plots seem strange or absent.</p>
</div>
</div>
<p>205 samples are included in this study. [below table contains 207 entries, but 2 samples were not sequenced.]</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-616c66bb411caa6d2d2e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-616c66bb411caa6d2d2e">{"x":{"filter":"none","extensions":["Buttons","Scroller"],"data":[[1,2,7,8,9,10,11,12,13,15,17,19,20,21,22,23,24,25,26,27,28,29,31,32,33,35,36,38,41,42,43,45,46,47,49,50,51,52,53,54,55,56,57,60,61,62,64,65,66,67,68,69,70,71,73,74,75,77,79,81,83,84,85,86,88,89,90,92,96,97,98,100,101,104,105,108,109,110,112,114,115,116,117,119,121,122,123,125,130,131,134,135,138,139,140,144,145,147,148,149,150,151,152,154,155,156,157,159,160,161,162,163,165,166,167,168,169,170,171,172,174,176,177,178,184,185,186,189,191,192,193,194,195,198,200,203,204,205,206,207,208,209,210,211,212,213,214,215,217,218,221,224,228,229,230,232,235,236,238,240,248,250,251,252,253,254,255,259,261,262,263,264,269,273,274,277,278,279,281,282,283,284,285,286,289,291,293,294,295,297,302,306,307,311,312,314,316,317,318,319,327,328,329,330,331,332,333],["L011","L012","L070","M224","L054","L050","L060","L060","L062","L044","L044","L078","L024","L030","L001","L001","L022","L022","L004","L079","L079","L003","L034","L028","L028","L025","L033","L040","L070","L064","L083","L040","L067","L034","M248","M248","M219","M210","M210","M237","M237","M203","M203","M209","M214","M214","M201","M216","M216","L038","L038","M229","M229","M252","M253","L003","L030","L002","L063","L012","L040","L067","M253","M250","M206","M206","M205","M221","M221","M235","M235","M241","M226","M205","M201","M263","M224","M242","M264","M212","M212","L012","L070","L025","L062","L004","L086","L011","L057","L057","M246","M242","L057","L062","L073","L079","L083","M264","L018","L078","L024","L065","L064","L056","L002","L009","L020","L028","L060","L026","L027","M244","L072","M263","M202","M202","M250","L072","L072","L016","L068","L068","L043","L054","M222","M226","L018","L086","L082","L082","L078","L065","L008","L077","L050","L043","M222","H411","H411","H401","H401","H404","H404","H413","H413","H413","H408","H408","H403","H403","H405","M202","M213","L053","M235","M243","L077","L082","L087","L077","L052","L036","M229","L059","H405","H406","H406","M222","M252","L056","L002","L004","H408","H407","M209","M213","M216","M219","M232","M236","M254","M256","M261","M240","M225","M241","M254","M254","M257","M256","M253","L010","L030","L036","L065","L010","L016","L024","M242","M255","L008","L008","L043","M246","M225","L053","M243"],["PT","PT","PT","PT","PT","PT","PT","LNM","LNM","PT","LNM","PT","PT","LNM","PT","LNM","LNM","PT","LNM","LNM","PT","LNM","LNM","PT","LNM","REC","REC","REC","REC","PT","PT","PT","PT","PT","PT","LNM","PT","PT","LNM","PT","LNM","PT","LNM","LNM","PT","LNM","PT","PT","LNM","PT","LNM","PT","LNM","PT","LNM","PT","PT","LNM","REC","LNM","LNM","LNM","PT","LNM","PT","LNM","PT","PT","REC","PT","LNM","PT","REC","REC","REC","PT","LNM","PT","PT","LNM","PT","REC","LNM","PT","PT","PT","PT","REC","PT","LNM","PT","LNM","REC","REC","REC","REC","REC","REC","LNM","LNM","LNM","PT","REC","PT","REC","REC","REC","REC","REC","REC","REC","REC","REC","REC","PT","LNM","PT","PT","LNM","PT","PT","LNM","PT","LNM","LNM","PT","PT","LNM","PT","LNM","REC","LNM","REC","LNM","REC","REC","REC","PT","LNM","PT","LNM","PT","LNM","PT","LNM","REC","PT","LNM","PT","LNM","LNM","REC","REC","PT","REC","REC","REC","REC","REC","PT","REC","PT","REC","REC","PT","PT","LNM","PT","REC","LNM","PT","REC","REC","REC","PT","PT","REC","REC","REC","REC","REC","REC","REC","REC","REC","REC","PT","LNM","REC","PT","REC","PT","REC","REC","REC","REC","REC","REC","REC","REC","PT","LNM","LNM","LNM","PT","REC","PT"],["PT+DM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+LNM","PT+DM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM","DM","PT+DM+LNM","PT+DM+LNM","PT+DM","PT+DM","PT+DM+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+DM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+DM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM","PT+DM+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","DM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+DM+LNM","PT+LNM","PT+LNM","PT+LNM","PT+DM","PT+DM","PT+DM","PT+DM+LNM","PT+DM+LNM","PT+DM","PT+DM","PT+DM","PT+DM","PT+DM","PT+LNM","PT+DM+LNM","PT+DM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+DM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","DM","PT+DM+LNM","PT+DM","PT+DM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM","PT+LNM","PT+DM+LNM","DM","DM","PT+DM+LNM","PT+DM+LNM","DM","DM","DM","PT+DM+LNM","PT+DM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM","PT+LNM","PT+LNM","PT+DM+LNM","PT+LNM","PT+DM+LNM","PT+DM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM","PT+DM","PT+DM+LNM","PT+DM","PT+DM+LNM","PT+DM+LNM","DM","PT+DM+LNM","DM","PT+DM","PT+DM+LNM","DM","PT+LNM","PT+LNM","PT+LNM","PT+DM+LNM","PT+DM","PT+LNM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","DM","PT+LNM","PT+DM","PT+DM+LNM","PT+DM","DM","DM","PT+DM+LNM","PT+DM","DM","DM","PT+DM","PT+DM","PT+DM+LNM","PT+DM+LNM","DM","PT+DM","PT+DM+LNM","PT+DM","PT+DM+LNM","PT+DM","PT+DM+LNM","PT+DM","PT+DM","PT+DM+LNM","PT+DM+LNM","DM","PT+DM+LNM","PT+DM+LNM","PT+DM+LNM","PT+LNM","PT+DM","PT+DM","PT+DM"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Sample.ID<\/th>\n      <th>Studiekod<\/th>\n      <th>Tumor.location<\/th>\n      <th>Matched.or.not<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel"],"deferRender":true,"scrollY":200,"scroller":true,"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="material-and-methods" class="level1 page-columns page-full">
<h1>Material and Methods</h1>
<section id="preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing">Preprocessing</h2>
<p>Raw reads were trimmed using TrimGalore v0.6.1 prior to mapping to GRCh37 using bwa mem of bwa v0.7.17. Subsequently, duplicates were tagged and removed using MarkDuplicates from picard v2.23.4. Base recalibration was performed and applied using GATK v4.2.0 with known sites datasets dbsnp_138, 1000G_phase1 and Mills_and_1000G_gold_Standard_indels.</p>
</section>
<section id="variant-calling" class="level2">
<h2 class="anchored" data-anchor-id="variant-calling">Variant Calling</h2>
<p>Somatic variant calling of all samples was performed by combining the results of three variant callers; i.e.&nbsp;Mutect2 v4.2.0, VarScan v2.4.2 and freebayes v1.3.2. These were chosen because they are capable of running without a matched normal sample. Mutect2 was supplied with a generic panel-of-normals (“somatic-b37-Mutect2-exome-panel”) and a germline resource (“gnomAD.r2.1.1.GRCh37.PASS.AC.AF.only”). VarScan was run with standard parameters and freebayes was run with -F 0.01 -C 5 –pooled-continuous and subsequently filtered to retain calls with QUAL &gt; 20. Variant calling was restricted to the list of targets used for the hybrid capture. Variants found in all three callers were called again using the <em>call</em> command from bcftools 1.14 and annotated with VEP v99 using the <em>vcf2maf.pl</em> script from vcf2maf v1.6.21.</p>
<p>Additionally, somatic calling for the distant and lymph node metastases was done in a more rigorous manner. For these samples, the matched primary tumor was used as a <em>pseudo</em> normal sample and variant calling was performed by Mutect2 only. A custom panel-of-normals was created from the primary tumors using the <em>CreateSomaticPanelOfNormals</em> command from GATK. The same germline resource was used as the one employed for the primary tumor analysis. Contamination was estimated and Mutect2 calls were filtered as per the appropriate <a href="https://gatk.broadinstitute.org/hc/en-us/articles/360035531132">GATK workflow</a>. Keep in mind that this protocol only detects variants that are a variant in the metastatic sample but not in the primary tumor. It does not tell us anything about the variants of the primary tumor in itself; if both primary and metasasis have the variant it is not withheld in this analysis.</p>
</section>
<section id="filtering" class="level2">
<h2 class="anchored" data-anchor-id="filtering">Filtering</h2>
<p>In addition to taking the intersect of the results of the three variant callers, variants which are present at a variant allele frequency (VAF) &gt; 1% in the Genome Aggregation Database (gnomAD) were removed. Files with raw and filtered variant calls are provided witht his report.</p>
</section>
<section id="copy-number-analysis" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="copy-number-analysis">Copy Number Analysis</h2>
<p>For a rough estimation of the copy number alterations in the metastases, the R package pureCN was used <span class="citation" data-cites="riester_purecn:_2016">(<a href="#ref-riester_purecn:_2016" role="doc-biblioref">Riester et al.</a>)</span>. It was designed for hybrid capture sequencing data, especially with medium-sized targeted gene panels without matching normal samples in mind (matched whole-exome data is of course supported). The primary tumors were used to create a <em>pseudo</em> normal coverage profile which is then compared to the metastatic sample. Keep in mind that this means that any copy number alteration is a change in the metastasis as compared to the primary tumor. It does not tell us anything about the status of the primary tumor in intself.</p>
<div class="no-row-height column-margin column-container"><div id="ref-riester_purecn:_2016" class="csl-entry" role="doc-biblioentry">
Riester, Markus, et al. <span>“<span>PureCN</span>: Copy Number Calling and <span>SNV</span> Classification Using Targeted Short Read Sequencing.”</span> <em>Source Code for Biology and Medicine</em>, vol. 11, no. 1, Dec. 2016, p. 13, <a href="https://doi.org/10.1186/s13029-016-0060-z">https://doi.org/10.1186/s13029-016-0060-z</a>.
</div></div><p>Analysis of the copy number alterations in the primary tumors was considered to be too unreliable without a matched normal sample.</p>
</section>
<section id="tumor-mutational-burden" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="tumor-mutational-burden">Tumor Mutational Burden</h2>
<p>To calculate the TMB, the R package TMBLeR was used <span class="citation" data-cites="fancello_tmbler_2021">(<a href="#ref-fancello_tmbler_2021" role="doc-biblioref">Fancello et al.</a>)</span>. The TMB is defined here as the number of mutations per Mb, excluding known cancer mutations but including synonymous mutations. There are several ways to define and filter the TMB. The filtering used here is described as well in the TMBLeR’s manual.</p>
<div class="no-row-height column-margin column-container"><div id="ref-fancello_tmbler_2021" class="csl-entry" role="doc-biblioentry">
Fancello, Laura, et al. <span>“<span>TMBleR</span>, a Bioinformatic Tool to Optimize <span>TMB</span> Estimation and Predictive Power.”</span> <em>Bioinformatics (Oxford, England)</em>, Dec. 2021, p. btab836, <a href="https://doi.org/10.1093/bioinformatics/btab836">https://doi.org/10.1093/bioinformatics/btab836</a>.
</div></div></section>
</section>
<section id="results" class="level1 page-columns page-full">
<h1>Results</h1>
<p>Modern high throughput sequencers can generate hundreds of millions of sequences in a single run. Before analysing this sequences to draw biological conclusions you should always perform some simple quality control checks to ensure that the raw data looks good and there are no problems or biases in your data which may affect how you can usefully use it. Therefore, a quality control step was run on the raw reads before and after trimming by the tool <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastqQC</a>. Three samples are corrupted and were removed (11,12 and 19).</p>
<section id="quality-control" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="quality-control">Quality control</h2>
<section id="fastqc" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="fastqc">FastQC</h3>
<div class="panel-tabset column-body-outset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Before Trimming</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">After Trimming</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>FastQC was run on the raw sequences as they are delivered by the sequencing facility. Read1 and Read2 are considered separately. Here we mainly look for outlier samples.</p>
<div id="fig-pre-trim-qc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/QC/multiqc_report.html">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Pre Trim QC</figcaption><p></p>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>The tool was run again after removal of low quality bases and adapter sequences.</p>
<div id="fig-pre-trim-qc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/QC/multiqc_report_after_trim.html">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2: Post Trim QC</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>Overall, the quality is sufficient to proceed with the analysis.</p>
</section>
<section id="coverage" class="level3">
<h3 class="anchored" data-anchor-id="coverage">Coverage</h3>
<p>The number of reads overlapping a specific nucleotide is an important quality metric because it will influence the confidence in the subsequent variant calls. Moreover, the more reads cover the target, the better we will be able to detect small clones. After mapping the trimmed reads to the genome, the average read depth per target (7455 targets in total) and per sample is calculated. The results per sample are shown in <a href="#fig-coverage-plot">Figure&nbsp;3</a>.</p>
<div id="fig-coverage-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./Results/QC/coverage/Coverage_Plot.svg" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3: Average Coverage per target per sample</figcaption><p></p>
</figure>
</div>
<p>Sample 224 and 28 have rather low coverage (22x and 33x respectively), but are kept in for the further downstream analysis. But good to keep in mind. The other samples have an average coverage beween 250x and 500x which is sufficient for somatic variant calling in heterogeneous tumors.</p>
</section>
</section>
<section id="variant-calling-1" class="level2">
<h2 class="anchored" data-anchor-id="variant-calling-1">Variant Calling</h2>
<p>Here you can find the results of the variant calling analysis for the different sample groups.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Primary Tumor</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Distant Metastases</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Lymph Node Metastases</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>The primary tumors have been called by three different variant callers and the intersect of the SNPs of these three tools was retained for further analysis. The standard format to store variant information is as VCF files.</p>
<p><a href="/Results/all_samples_freebayes.tar.gz" download=""><button class="btn"><i class="fa fa-download"></i> Download Primary Tumor VCF Files - Freebayes only</button></a></p>
<p><a href="./Results/all_samples_varscan.tar.gz" download=""><button class="btn"><i class="fa fa-download"></i> Download Primary Tumor VCF Files - VarScan only</button></a></p>
<p><a href="./Results/all_samples_mutect2.tar.gz" download=""><button class="btn"><i class="fa fa-download"></i> Download Primary Tumor VCF Files - Mutect2 only</button></a></p>
<p><a href="./Results/all_samples/3_common_vcf.tar.gz" download=""><button class="btn"><i class="fa fa-download"></i> Download Primary Tumor VCF Files - Combined Variants</button></a></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Overview</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Oncoplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div id="fig-pt-overview" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/Primary_Tumor_Summary_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4: Overview of Primary Tumor samples.</figcaption><p></p>
</figure>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div id="fig-pt-oncoplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/oncoplots/Distant_Tumor_Oncoplot_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 5: Oncoplot of Primary Tumor samples.</figcaption><p></p>
</figure>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div id="fig-pt-oncoplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/oncoplots/Distant_Tumor_Oncoplot_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 6: Co-occurrence of common mutations.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p><a href="./Results/distant_tumor_mutect2.tar.gz" download=""><button class="btn"><i class="fa fa-download"></i> Download Distant Tumor VCF Files - Mutect2 only</button></a></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Overview</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Oncoplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div id="fig-dt-overview" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/Primary_Tumor_Summary_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 7: Overview of Primary Tumor samples.</figcaption><p></p>
</figure>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div id="fig-dt-oncoplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/oncoplots/Distant_Tumor_Oncoplot_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 8: Oncoplot of Primary Tumor samples.</figcaption><p></p>
</figure>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div id="fig-dt-oncoplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/oncoplots/Distant_Tumor_Oncoplot_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 9: Co-occurrence of common mutations.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p><a href="./Results/lymph_node_tumor_mutect2.tar.gz" download=""><button class="btn"><i class="fa fa-download"></i> Download Lymph Node Tumor VCF Files - Mutect2 only</button></a></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Overview</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Oncoplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Interaction</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div id="fig-lnm-overview" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/Primary_Tumor_Summary_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 10: Overview of Primary Tumor samples.</figcaption><p></p>
</figure>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div id="fig-lnm-oncoplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/oncoplots/Distant_Tumor_Oncoplot_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 11: Oncoplot of Primary Tumor samples.</figcaption><p></p>
</figure>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div id="fig-lnm-oncoplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<iframe src="./Results/all_samples/merged/3_common/oncoplots/Distant_Tumor_Oncoplot_3_common.pdf" style="width:100%; height:700px;">
</iframe>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 12: Co-occurrence of common mutations.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="tumor-mutational-burden-1" class="level2">
<h2 class="anchored" data-anchor-id="tumor-mutational-burden-1">Tumor Mutational Burden</h2>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-d5773dc04c8b7d9277c5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d5773dc04c8b7d9277c5">{"x":{"filter":"none","extensions":["Buttons","Scroller"],"data":[[1,10,100,101,104,105,108,109,110,112,114,115,116,117,119,121,122,123,125,13,131,134,135,138,139,140,144,145,147,148,149,15,150,151,152,154,155,156,157,159,160,161,162,163,166,167,168,169,17,170,171,172,174,176,177,178,184,185,186,189,191,192,193,194,195,198,2,20,200,203,204,205,206,207,208,209,21,210,211,212,213,214,215,217,218,22,221,224,228,229,23,230,232,235,236,238,24,240,248,25,250,251,252,253,254,255,259,26,261,262,263,264,269,27,273,274,277,278,279,28,281,282,283,284,285,286,289,29,291,293,294,295,297,302,306,307,31,311,312,314,316,317,318,319,32,327,328,329,33,330,331,332,333,35,36,38,41,42,43,45,46,47,49,50,51,52,53,54,55,56,57,60,61,62,64,65,66,67,68,69,7,70,71,73,74,75,77,79,8,81,83,84,85,86,88,89,9,90,92,96,97,98],["vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts","vaf=0NoCancerMuts"],[1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452,1.286452],[780,575,530,510,489,551,537,548,555,518,541,539,523,529,528,518,519,534,534,632,537,509,553,533,510,546,501,540,523,512,503,574,485,476,496,526,559,546,557,515,507,513,527,533,534,551,540,536,586,509,527,536,539,550,553,527,538,518,505,527,508,509,490,512,548,487,812,583,553,561,530,518,532,533,529,499,554,497,534,531,526,472,487,532,537,560,512,1633,550,522,562,562,505,488,511,525,504,489,537,511,523,511,511,518,552,540,533,524,538,534,558,527,501,660,551,531,544,529,545,1199,520,577,547,530,557,511,489,519,539,548,548,489,533,538,553,561,553,541,463,544,572,496,579,494,521,567,589,570,510,511,493,539,555,519,582,507,483,529,562,514,576,516,563,563,561,537,564,548,549,535,525,538,525,526,515,522,511,533,584,508,577,513,543,531,510,530,556,550,624,652,517,590,528,525,538,530,607,494,539,543,543,556],[606.32,446.97,411.99,396.44,380.12,428.31,417.43,425.98,431.42,402.66,420.54,418.98,406.54,411.21,410.43,402.66,403.44,415.1,415.1,491.27,417.43,395.66,429.86,414.32,396.44,424.42,389.44,419.76,406.54,397.99,391,446.19,377.01,370.01,385.56,408.88,434.53,424.42,432.97,400.33,394.11,398.77,409.65,414.32,415.1,428.31,419.76,416.65,455.52,395.66,409.65,416.65,418.98,427.53,429.86,409.65,418.2,402.66,392.55,409.65,394.88,395.66,380.89,397.99,425.98,378.56,631.19,453.18,429.86,436.08,411.99,402.66,413.54,414.32,411.21,387.89,430.64,386.33,415.1,412.76,408.88,366.9,378.56,413.54,417.43,435.31,397.99,1269.38,427.53,405.77,436.86,436.86,392.55,379.34,397.22,408.1,391.78,380.12,417.43,397.22,406.54,397.22,397.22,402.66,429.09,419.76,414.32,407.32,418.2,415.1,433.75,409.65,389.44,513.04,428.31,412.76,422.87,411.21,423.65,932.02,404.21,448.52,425.2,411.99,432.97,397.22,380.12,403.44,418.98,425.98,425.98,380.12,414.32,418.2,429.86,436.08,429.86,420.54,359.9,422.87,444.63,385.56,450.08,384,404.99,440.75,457.85,443.08,396.44,397.22,383.22,418.98,431.42,403.44,452.41,394.11,375.45,411.21,436.86,399.55,447.74,401.1,437.64,437.64,436.08,417.43,438.42,425.98,426.76,415.87,408.1,418.2,408.1,408.88,400.33,405.77,397.22,414.32,453.96,394.88,448.52,398.77,422.09,412.76,396.44,411.99,432.2,427.53,485.06,506.82,401.88,458.63,410.43,408.1,418.2,411.99,471.84,384,418.98,422.09,422.09,432.2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Sample<\/th>\n      <th>Filter<\/th>\n      <th>Sequencing_Size<\/th>\n      <th>Tot_Number_Mutations<\/th>\n      <th>TMB_per_Mb<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel"],"deferRender":true,"scrollY":200,"scroller":true,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="copy-number-alteration" class="level2">
<h2 class="anchored" data-anchor-id="copy-number-alteration">Copy Number Alteration</h2>
<p>Copy number alterations were estimated using the R package pureCN. In this analysis, metastases were compared to their matched primary tumor. It is important to keep in mind that therefore these results can be affected by the state of the primary tumor as well; e.g.&nbsp;an amplification in a lymph node tumor might indicate a deletion in the matched primary tumor rather than a genuine amplification.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Distant Metastases</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Lymph Node Metastases</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>#<code>{r} #dmag &lt;- read.csv("./Results/CNA/distant_tumor/all_genes_alt.csv", sep = ";") #datatable(meta, rownames = FALSE, extensions = c('Buttons', 'Scroller'), options = list(dom = 'Bfrtip', buttons = c("copy", "csv", "excel"), deferRender = TRUE, scrollY = 200, scroller = TRUE)) #</code></p>
<p>The full results of the pureCN analysis per patient can be downloaded with the button below. There are several files per patient here and not all are even informative. The per gene statistics for each sample can for example be found in the *_genes.csv files. A description of the columns in this genes.csv file can be found in Table 2 of <a href="https://bioconductor.org/packages/release/bioc/vignettes/PureCN/inst/doc/PureCN.pdf">the pureCN manual</a>.</p>
<p><a href="https://uppsala.box.com/s/zuhdyge2uhwg9mgkoas5gob7b34mby6v" download=""><button class="btn"><i class="fa fa-download"></i> Download Distant Metastases CNA data</button></a></p>
<div class="quarto-layout-panel" height="1500px">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cna-dm-amp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./Results/CNA/distant_tumor/Amplified_in_distant_tumor_vs_primary_tumor.png" class="img-fluid figure-img" data-ref-parent="fig-cna-dm"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(a) Amplified</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cna-dm-del" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./Results/CNA/distant_tumor/Deleted_in_distant_tumor_vs_primary_tumor.png" class="img-fluid figure-img" data-ref-parent="fig-cna-dm"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(b) Deleted</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 13: Most Common Alterations in Distant Tumor versus Primary Tumor.</figcaption><p></p>
</figure>
</div>
<p>Here you can see the results per patient.</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="273" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 272;"><span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>viewof plot <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(plots<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Choose Patient"</span> })</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;p&gt;&lt;/p&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="283" data-source-offset="-49"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 282;"><span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;iframe src="./Results/CNA/distant_tumor/</span><span class="sc">${</span>plot<span class="sc">}</span><span class="vs">_segmentation.pdf" style="width:100%; height:700px;"&gt;&lt;/iframe&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-test" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 14: Test Dropdown</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="288" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 287;"><span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>all_genes_lnm <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"./Results/CNA/lymph_node/all_genes.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({<span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>columns_lnm <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">15</span>]<span class="op">.</span><span class="fu">map</span>(x<span class="kw">=&gt;</span>all_genes_lnm<span class="op">.</span><span class="at">columns</span>[x])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell panel-input card bg-light p-2">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="295" data-source-offset="-17"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 294;"><span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a>viewof gene_lnm <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(all_genes_lnm<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">genesymbol</span>)<span class="op">,</span> {<span class="dt">unique</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Select a gene: "</span>})</span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a>viewof type_lnm <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="st">"AMPLIFICATION"</span><span class="op">,</span> <span class="st">"DELETION"</span><span class="op">,</span> <span class="st">"NA"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Select type of alteration: "</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="st">"AMPLIFICATION"</span><span class="op">,</span> <span class="st">"DELETION"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="299" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 298;"><span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a>filtered_lnm <span class="op">=</span> all_genes_lnm<span class="op">.</span><span class="fu">filter</span>(<span class="kw">function</span>(dat) { <span class="cf">return</span> gene_lnm<span class="op">.</span><span class="fu">includes</span>(dat<span class="op">.</span><span class="at">genesymbol</span>) <span class="op">&amp;&amp;</span> type_lnm<span class="op">.</span><span class="fu">includes</span>(dat<span class="op">.</span><span class="at">type</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="303" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 302;"><span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">table</span>(filtered_lnm<span class="op">,</span> {<span class="dt">columns</span><span class="op">:</span> columns_lnm})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="expression">

</div>
</div>
</div>
<p>The full results of the pureCN analysis per patient can be downloaded here. There are several files per patient here and not all are even informative. The per gene statistics for each sample can for example be found in the *_genes.csv files. A description of the columns in this genes.csv file can be found in Table 2 of <a href="https://bioconductor.org/packages/release/bioc/vignettes/PureCN/inst/doc/PureCN.pdf">the pureCN manual</a>.</p>
<p><a href="./Results/lymph_node_tumor_copy_number_data.tar.gz" download=""><button class="btn"><i class="fa fa-download"></i> Download Lymph Node Metastases CNA data</button></a></p>
<div class="quarto-layout-panel" height="1500px">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cna-lnm-amp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./Results/CNA/lymph_node/Amplified_in_lymph_node_vs_primary_tumor.png" class="img-fluid figure-img" data-ref-parent="fig-cna-lnm"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(a) Amplified</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cna-lnm-del" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="./Results/CNA/lymph_node/Deleted_in_lymph_node_vs_primary_tumor.png" class="img-fluid figure-img" data-ref-parent="fig-cna-lnm"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(b) Deleted</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 15: Most Common Alterations in Lymph Node Tumor versus Primary Tumor.</figcaption><p></p>
</figure>
</div>
<p>Here you can see the results per patient.</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="330" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 329;"><span id="cb7-330"><a href="#cb7-330" aria-hidden="true" tabindex="-1"></a>viewof plot_lnm <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(plots_lnm<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Choose Patient"</span> })</span>
<span id="cb7-331"><a href="#cb7-331" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;p&gt;&lt;/p&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="340" data-source-offset="-52"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 339;"><span id="cb8-340"><a href="#cb8-340" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;iframe src="./Results/CNA/lymph_node//</span><span class="sc">${</span>plot_lnm<span class="sc">}</span><span class="vs">_segmentation.pdf" style="width:100%; height:700px;"&gt;&lt;/iframe&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-lnm-seg" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div id="ojs-cell-8" data-nodetype="expression">

</div>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 16: Test Dropdown</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="nanostring-data" class="level2">
<h2 class="anchored" data-anchor-id="nanostring-data">Nanostring data</h2>
</section>
</section>
<section id="data-responsibility" class="level1">
<h1>Data Responsibility</h1>
<ul>
<li><strong>NBIS &amp; Uppnex</strong> Unfortunately, we do not have resources to keep any files associated with the support request. We suggest that you safely store the results delivered by us. In addition, we ask that you remove the files from UPPMAX/UPPNEX after analysis is completed. The main storage at UPPNEX is optimized for high-speed and parallel access, which makes it expensive and not the right place for long time archiving.</li>
<li><strong>Sensitive data</strong> Please note that special considerations may apply to the human-derived sensitive personal data. These should be handled according to specific laws and regulations.</li>
<li><strong>Long-term backup</strong> The responsibility for data archiving lies with universities and we recommend asking your local IT for support with long-term data archiving. Also the newly established Data Office at SciLifeLab may be of help to discuss other options.</li>
</ul>
</section>
<section id="acknowledgements" class="level1">
<h1>Acknowledgements</h1>
<p>If you are presenting the results in a paper, at a workshop or conference, we kindly ask you to acknowledge us.</p>
<ul>
<li><p><strong>NBIS Staff</strong> are encouraged to be co-authors when this is merited in accordance to the ethical recommendations for authorship, e.g.&nbsp;<a href="http://www.icmje.org/recommendations/browse/roles-and-responsibilities/defining-the-role-of-authors-and-contributors.html">ICMJE recommendations</a>. If applicable, please include <strong>Vincent van Hoef, National Bioinformatics Infrastructure Sweden, Science for Life Laboratory, Uppsala University</strong>, as co-author. In other cases, NBIS would be grateful if support by us is acknowledged in publications according to this example: <a href="https://www.nbis.se/resources/support.html">“Support by NBIS (National Bioinformatics Infrastructure Sweden) is gratefully acknowledged”</a>.</p></li>
<li><p><strong>UPPMAX</strong> If your project has used HPC resources we kindly asks you to acknowledge UPPMAX and SNIC. If applicable, please add: <a href="https://www.uppmax.uu.se/support/faq/general-miscellaneous-faq/acknowledging-uppmax--snic--and-uppnex/">“The computations were performed on resources provided by SNIC through Uppsala Multidisciplinary Center for Advanced Computational Science (UPPMAX) under Project SNIC XXXX/Y-ZZZ”</a>.</p></li>
<li><p><strong>NGI</strong> In publications based on data from NGI Sweden, the authors must acknowledge SciLifeLab, NGI and UPPMAX: <a href="https://ngisweden.scilifelab.se/info/faq#how-do-i-acknowledge-ngi-in-my-publication">“The authors would like to acknowledge support from Science for Life Laboratory, the National Genomics Infrastructure, NGI, and Uppmax for providing assistance in massive parallel sequencing and computational infrastructure”</a>.</p></li>
</ul>
</section>
<section id="closing-procedures" class="level1">
<h1>Closing Procedures</h1>
<p>You should soon be contacted by one of our managers, <a href="jessica.lindvall@nbis.se">Jessica Lindvall</a> or <a href="henrik.lantz@nbis.se">Henrik Lantz</a>, with a request to close down the project in our internal system and for invoicing matters. If we do not hear from you within <strong>30 days</strong> the project will be automatically closed and invoice sent. Again, we would like to remind you about data responsibility and acknowledgements, see Data Responsibility and Acknowledgments sections.</p>
<p>You are naturally more than welcome to come back to us with further data analysis request at any time via <a href="http://nbis.se/support/support.html">NBIS support</a>.</p>
<p>Thank you for using NBIS and all the best for future research.</p>

</section>

</main>
<!-- /main column -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"viewof plot = Inputs.select(plots, { label: \"Choose Patient\" })\nhtml`<p></p>`\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"//| label: fig-test\n//| fig-cap: \"Test Dropdown\"\nhtml`<iframe src=\"./Results/CNA/distant_tumor/${plot}_segmentation.pdf\" style=\"width:100%; height:700px;\"></iframe>`\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"all_genes_lnm = FileAttachment(\"./Results/CNA/lymph_node/all_genes.csv\").csv({typed: true})\ncolumns_lnm = [0,1,2,3,4,15].map(x=>all_genes_lnm.columns[x])\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"//| panel: input\nviewof gene_lnm = Inputs.select(all_genes_lnm.map(d => d.genesymbol), {unique: true, label: \"Select a gene: \"})\nviewof type_lnm = Inputs.checkbox([\"AMPLIFICATION\", \"DELETION\", \"NA\"], {label: \"Select type of alteration: \", value: [\"AMPLIFICATION\", \"DELETION\"]})\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"filtered_lnm = all_genes_lnm.filter(function(dat) { return gene_lnm.includes(dat.genesymbol) && type_lnm.includes(dat.type)})\n"},{"methodName":"interpret","cellName":"ojs-cell-6","inline":false,"source":"Inputs.table(filtered_lnm, {columns: columns_lnm})\n"},{"methodName":"interpret","cellName":"ojs-cell-7","inline":false,"source":"viewof plot_lnm = Inputs.select(plots_lnm, { label: \"Choose Patient\" })\nhtml`<p></p>`\n"},{"methodName":"interpret","cellName":"ojs-cell-8","inline":false,"source":"//| label: fig-lnm-seg\n//| fig-cap: \"Test Dropdown\"\nhtml`<iframe src=\"./Results/CNA/lymph_node//${plot_lnm}_segmentation.pdf\" style=\"width:100%; height:700px;\"></iframe>`\n"},{"methodName":"interpretQuiet","source":"shinyInput('plot')"},{"methodName":"interpretQuiet","source":"shinyInput('gene_lnm')"},{"methodName":"interpretQuiet","source":"shinyInput('type_lnm')"},{"methodName":"interpretQuiet","source":"shinyInput('plot_lnm')"}]}
</script>
<script type="module">
window._ojs.paths.runtimeToDoc = "../../..";
window._ojs.paths.runtimeToRoot = "../../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>